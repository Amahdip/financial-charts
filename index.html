<!DOCTYPE html>
<html lang="fa" dir="rtl">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>روند داده‌های مقیاس‌شده - Iran Macro</title>
		<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
		<link rel="stylesheet" href="styles.css" />
	</head>
	<body>
		<div class="container">
			<h1>روند داده‌های مقیاس‌شده</h1>
			<div class="subtitle">تحلیل جامع شاخص‌های مالی (1398 تا 1404)</div>

			<!-- Tab Navigation -->
			<div class="tab-navigation">
				<button class="tab-button active" onclick="switchTab('chart1')">
					شاخص‌های مالی
				</button>
				<button class="tab-button" onclick="switchTab('chart2')">
					شاخص‌های جایگزین
				</button>
				<button class="tab-button" onclick="switchTab('tables')">جداول</button>
			</div>

			<div class="stats-grid">
				<div class="stat-card">
					<div class="stat-value" style="color: #3182ce">3,108,119</div>
					<div class="stat-label">بالاترین شاخص بورس</div>
				</div>
				<div class="stat-card">
					<div class="stat-value" style="color: #e53e3e">94,677,309</div>
					<div class="stat-label">بالاترین ارزش کل بورس (ریال)</div>
				</div>
				<div class="stat-card">
					<div class="stat-value" style="color: #38a169">977,800</div>
					<div class="stat-label">بالاترین نرخ دلار (ریال)</div>
				</div>
				<div class="stat-card">
					<div class="stat-value" style="color: #d69e2e">266</div>
					<div class="stat-label">بالاترین ارزش کل بورس (دلار)</div>
				</div>
			</div>

			<button class="pdf-button" onclick="generatePDF()">📄 PDF</button>

			<!-- Chart Containers -->
			<div id="chart1" class="chart-container active">
				<canvas id="myChart"></canvas>
			</div>

			<div id="chart2" class="chart-container">
				<canvas id="myChart2"></canvas>
			</div>

			<div id="tables" class="chart-container">
				<div class="tables-content">
					<div class="table-layout">
						<div class="table-section">
							<!-- EV/Revenue Category -->
							<div id="ev-revenue-category" class="category-content active">
								<div id="ev-revenue-original-table" class="sub-table active">
									<div class="table-container">
										<table>
											<thead>
												<tr>
													<th>ردیف</th>
													<th>شرح</th>
													<th>مبلغ (میلیون ریال)</th>
												</tr>
											</thead>
											<tbody id="ev-revenue-original-body">
												<!-- Data will be populated by JavaScript -->
											</tbody>
										</table>
									</div>
								</div>

								<div id="ev-revenue-corrected-table" class="sub-table">
									<div class="table-container">
										<table>
											<thead>
												<tr>
													<th>ردیف</th>
													<th>شرح</th>
													<th>مبلغ (میلیون ریال)</th>
												</tr>
											</thead>
											<tbody id="ev-revenue-corrected-body">
												<!-- Data will be populated by JavaScript -->
											</tbody>
										</table>
									</div>
								</div>

								<div id="ev-revenue-2022-table" class="sub-table">
									<div class="table-container">
										<table>
											<thead>
												<tr>
													<th>ردیف</th>
													<th>شرح</th>
													<th>مبلغ (میلیون ریال)</th>
												</tr>
											</thead>
											<tbody id="ev-revenue-2022-body">
												<!-- Data will be populated by JavaScript -->
											</tbody>
										</table>
									</div>
								</div>

								<div id="ev-revenue-custom-table" class="sub-table">
									<div class="table-container">
										<table>
											<thead>
												<tr>
													<th>ردیف</th>
													<th>شرح</th>
													<th>مبلغ (میلیون ریال)</th>
												</tr>
											</thead>
											<tbody id="ev-revenue-custom-body">
												<!-- Data will be populated by JavaScript -->
											</tbody>
										</table>
									</div>
								</div>
							</div>

							<!-- P/E Category -->
							<div id="pe-category" class="category-content">
								<div id="pe-original-table" class="sub-table active">
									<div class="table-container">
										<table>
											<thead>
												<tr>
													<th>ردیف</th>
													<th>شرح</th>
													<th>مبلغ (میلیون ریال)</th>
												</tr>
											</thead>
											<tbody id="pe-original-body">
												<!-- Data will be populated by JavaScript -->
											</tbody>
										</table>
									</div>
								</div>

								<div id="pe-corrected-table" class="sub-table">
									<div class="table-container">
										<table>
											<thead>
												<tr>
													<th>ردیف</th>
													<th>شرح</th>
													<th>مبلغ (میلیون ریال)</th>
												</tr>
											</thead>
											<tbody id="pe-corrected-body">
												<!-- Data will be populated by JavaScript -->
											</tbody>
										</table>
									</div>
								</div>

								<div id="pe-2022-table" class="sub-table">
									<div class="table-container">
										<table>
											<thead>
												<tr>
													<th>ردیف</th>
													<th>شرح</th>
													<th>مبلغ (میلیون ریال)</th>
												</tr>
											</thead>
											<tbody id="pe-2022-body">
												<!-- Data will be populated by JavaScript -->
											</tbody>
										</table>
									</div>
								</div>

								<div id="pe-custom-table" class="sub-table">
									<div class="table-container">
										<table>
											<thead>
												<tr>
													<th>ردیف</th>
													<th>شرح</th>
													<th>مبلغ (میلیون ریال)</th>
												</tr>
											</thead>
											<tbody id="pe-custom-body">
												<!-- Data will be populated by JavaScript -->
											</tbody>
										</table>
									</div>
								</div>
							</div>
						</div>

						<div class="controls-section">
							<div class="category-controls">
								<button
									class="category-btn active"
									onclick="showCategory('ev-revenue')"
								>
									EV/Revenue
								</button>
								<button class="category-btn" onclick="showCategory('pe')">
									P/E
								</button>
							</div>

							<div class="subcategory-controls">
								<button
									class="subcategory-btn active"
									onclick="showSubTable('ev-revenue', 'original')"
								>
									جداول اصلی گزارش
								</button>
								<button
									class="subcategory-btn"
									onclick="showSubTable('ev-revenue', 'corrected')"
								>
									جداول اصلی گزارش با نسبت‌های صحیح
								</button>
								<button
									class="subcategory-btn"
									onclick="showSubTable('ev-revenue', '2022')"
								>
									جداول گزارش در پایان سال ۱۴۰۱
								</button>
								<button
									class="subcategory-btn"
									onclick="showSubTable('ev-revenue', 'custom')"
								>
									جداول با شرکت‌های متناسب
								</button>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>

		<script>
			// PDF Generation Function
			async function generatePDF() {
				try {
					// Show loading state
					const button = document.querySelector('.pdf-button');
					const originalText = button.innerHTML;
					button.innerHTML = '⏳ در حال ایجاد...';
					button.disabled = true;

					// Get the chart canvas directly
					const chartCanvas = document.getElementById('myChart');

					// Create a temporary container
					const tempContainer = document.createElement('div');
					tempContainer.style.position = 'absolute';
					tempContainer.style.left = '-9999px';
					tempContainer.style.top = '0';
					tempContainer.style.width = '1400px';
					tempContainer.style.height = '900px';
					tempContainer.style.background = 'white';
					tempContainer.style.padding = '40px';
					tempContainer.style.fontFamily = 'IRANSansX, Arial, sans-serif';
					tempContainer.style.direction = 'rtl';

					// Add title
					const title = document.createElement('h1');
					title.textContent = 'روند داده‌های مقیاس‌ شده';
					title.style.textAlign = 'center';
					title.style.color = '#1a202c';
					title.style.marginBottom = '10px';
					title.style.fontSize = '28px';
					title.style.fontWeight = '700';
					title.style.letterSpacing = '2px';
					title.style.background = 'none';
					title.style.webkitBackgroundClip = 'unset';
					title.style.webkitTextFillColor = 'unset';
					title.style.backgroundClip = 'unset';

					const subtitle = document.createElement('div');
					subtitle.textContent = 'تحلیل جامع شاخص‌های مالی (1398 تا 1404)';
					subtitle.style.textAlign = 'center';
					subtitle.style.color = '#718096';
					subtitle.style.fontSize = '16px';
					subtitle.style.marginBottom = '30px';

					// Create chart container
					const chartDiv = document.createElement('div');
					chartDiv.style.width = '100%';
					chartDiv.style.height = '700px';
					chartDiv.style.background = 'white';
					chartDiv.style.border = '1px solid #e2e8f0';
					chartDiv.style.borderRadius = '8px';
					chartDiv.style.padding = '20px';
					chartDiv.style.textAlign = 'center';
					chartDiv.style.direction = 'rtl';

					// Create new canvas for the chart
					const newCanvas = document.createElement('canvas');
					newCanvas.width = 1300;
					newCanvas.height = 650;
					newCanvas.style.margin = '0 auto';
					newCanvas.style.display = 'block';
					chartDiv.appendChild(newCanvas);

					// Create stats grid for PDF
					const statsGrid = document.createElement('div');
					statsGrid.style.display = 'grid';
					statsGrid.style.gridTemplateColumns = 'repeat(4, 1fr)';
					statsGrid.style.gap = '20px';
					statsGrid.style.marginBottom = '30px';
					statsGrid.style.marginTop = '20px';

					// Add stat cards
					const statCards = [
						{
							value: '3,108,119',
							label: 'بالاترین شاخص بورس',
							color: '#3182ce',
						},
						{
							value: '94,677,309',
							label: 'ارزش کل بورس (ریال)',
							color: '#e53e3e',
						},
						{ value: '977,800', label: 'نرخ دلار (ریال)', color: '#38a169' },
						{
							value: '113,809',
							label: 'ارزش کل بورس (دلار)',
							color: '#d69e2e',
						},
					];

					statCards.forEach((card) => {
						const statCard = document.createElement('div');
						statCard.style.background = 'white';
						statCard.style.padding = '15px';
						statCard.style.borderRadius = '12px';
						statCard.style.boxShadow = '0 2px 4px rgba(0,0,0,0.1)';
						statCard.style.border = '1px solid #e2e8f0';
						statCard.style.textAlign = 'center';

						const statValue = document.createElement('div');
						statValue.textContent = card.value;
						statValue.style.fontSize = '18px';
						statValue.style.fontWeight = '700';
						statValue.style.color = card.color;
						statValue.style.marginBottom = '5px';

						const statLabel = document.createElement('div');
						statLabel.textContent = card.label;
						statLabel.style.fontSize = '12px';
						statLabel.style.color = '#718096';
						statLabel.style.fontWeight = '500';

						statCard.appendChild(statValue);
						statCard.appendChild(statLabel);
						statsGrid.appendChild(statCard);
					});

					tempContainer.appendChild(title);
					tempContainer.appendChild(subtitle);
					tempContainer.appendChild(statsGrid);
					tempContainer.appendChild(chartDiv);
					document.body.appendChild(tempContainer);

					// Create a new chart instance for PDF
					const pdfChart = new Chart(newCanvas, {
						...chartData,
						options: {
							...chartData.options,
							responsive: false,
							maintainAspectRatio: false,
							plugins: {
								...chartData.options.plugins,
								legend: {
									...chartData.options.plugins.legend,
									labels: {
										...chartData.options.plugins.legend.labels,
										font: {
											size: 14,
											family: "'IRANSansX', sans-serif",
											weight: '600',
										},
									},
								},
							},
							scales: {
								...chartData.options.scales,
								x: {
									...chartData.options.scales.x,
									ticks: {
										...chartData.options.scales.x.ticks,
										font: {
											size: 12,
											family: "'IRANSansX', sans-serif",
											weight: '500',
										},
									},
								},
								y: {
									...chartData.options.scales.y,
									ticks: {
										...chartData.options.scales.y.ticks,
										font: {
											size: 12,
											family: "'IRANSansX', sans-serif",
											weight: '500',
										},
									},
								},
							},
						},
					});

					// Wait for chart to render
					await new Promise((resolve) => setTimeout(resolve, 1000));

					// Convert to canvas using html2canvas
					const canvas = await html2canvas(tempContainer, {
						scale: 2,
						useCORS: true,
						allowTaint: true,
						backgroundColor: '#ffffff',
						width: 1400,
						height: 900,
						logging: false,
					});

					// Remove temporary container
					document.body.removeChild(tempContainer);

					// Create PDF
					const { jsPDF } = window.jspdf;
					const pdf = new jsPDF('landscape', 'mm', 'a4');

					// Calculate dimensions to fit the chart on one page
					const pageWidth = pdf.internal.pageSize.getWidth();
					const pageHeight = pdf.internal.pageSize.getHeight();
					const imgWidth = pageWidth - 20; // 10mm margin on each side
					const imgHeight = (canvas.height * imgWidth) / canvas.width;

					// If image is too tall, scale it down
					const maxHeight = pageHeight - 20; // 10mm margin on top and bottom
					const finalWidth =
						imgHeight > maxHeight
							? (maxHeight * imgWidth) / imgHeight
							: imgWidth;
					const finalHeight = imgHeight > maxHeight ? maxHeight : imgHeight;

					// Center the image on the page
					const x = (pageWidth - finalWidth) / 2;
					const y = (pageHeight - finalHeight) / 2;

					// Add the image to PDF
					pdf.addImage(
						canvas.toDataURL('image/png'),
						'PNG',
						x,
						y,
						finalWidth,
						finalHeight
					);

					// Save the PDF
					pdf.save('iran-macro-chart.pdf');

					// Restore button state
					button.innerHTML = originalText;
					button.disabled = false;
				} catch (error) {
					console.error('Error generating PDF:', error);
					alert('خطا در ایجاد PDF. لطفاً دوباره تلاش کنید.');

					// Restore button state
					const button = document.querySelector('.pdf-button');
					button.innerHTML = '📄 PDF';
					button.disabled = false;
				}
			}

			// Real data arrays for tooltips (unscaled values)
			const realData = {
				stockIndex: [
					204375,
					215168,
					233886,
					251278,
					266127,
					311471,
					305807,
					304997,
					356721,
					406008,
					478755,
					512900,
					708995,
					986759,
					1300813,
					1901169,
					1727265,
					1581206,
					1412355,
					1366535,
					1436393,
					1183978,
					1232716,
					1307657,
					1207047,
					1128164,
					1186906,
					1311306,
					1515887,
					1386466,
					1407758,
					1407133,
					1359011,
					1279450,
					1274305,
					1367250,
					1512219,
					1582144,
					1533394,
					1473498,
					1431477,
					1355241,
					1296798,
					1407654,
					1496201,
					1657577,
					1594263,
					1960457,
					2324133,
					2318507,
					2173893,
					null,
					null,
					null,
					2032212,
					2022787,
					2211856,
					2166928,
					2070775,
					2195092,
					2201987,
					2112560,
					2043980,
					2172192,
					2037209,
					2097005,
					2007281,
					2257614,
					2501778,
					2849940,
					2719339,
					2709764,
					3077924,
					3108119,
					2984605,
					2843904,
				],
				marketValueRial: [
					6225526,
					6554295,
					7124469,
					7654252,
					8106571,
					9487808,
					9315275,
					9290602,
					10866181,
					12367527,
					14583494,
					15623595,
					21596889,
					30057957,
					39624433,
					57912068,
					52614714,
					48165581,
					43022143,
					41626423,
					43754378,
					36065501,
					37550121,
					39832929,
					36768204,
					34365332,
					36154671,
					39944070,
					46175856,
					42233550,
					42882122,
					42863081,
					41397226,
					38973689,
					38816963,
					41648206,
					46064142,
					48194139,
					46709154,
					44884651,
					43604640,
					41282384,
					39502132,
					42878958,
					45576204,
					50491922,
					48563302,
					59718058,
					70796076,
					70624695,
					66219594,
					null,
					null,
					null,
					61903799,
					61616690,
					67375993,
					66007414,
					63078484,
					66865340,
					67075358,
					64351309,
					62262277,
					66167770,
					62056008,
					63877460,
					61144372,
					68769824,
					76207371,
					86812850,
					82834562,
					82542906,
					93757528,
					94677309,
					90914927,
					86628981,
				],
				dollarRate: [
					134700, 142350, 132000, 125240, 116000, 113930, 112320, 117940,
					131690, 134390, 143930, 149030, 154420, 177010, 194800, 218000,
					225020, 274970, 296440, 256200, 256040, 226450, 251710, 239630,
					241840, 223000, 242590, 246280, 276660, 275210, 274150, 284400,
					300770, 275250, 254170, 262520, 278620, 303230, 319780, 318830,
					293440, 316730, 328120, 356580, 397610, 439761, 499020, 481014,
					516069, 523310, 497310, 483360, 490230, 493930, 506362, 501990,
					500760, 542230, 570360, 603510, 600900, 605600, 614800, 576110,
					581600, 592300, 648550, 689300, 767550, 806700, 919950, 977800,
					827900, 831900, 835350, 881100,
				],
				marketValueUSD: [
					46,
					46,
					54,
					61,
					70,
					83,
					83,
					79,
					83,
					92,
					101,
					105,
					140,
					170,
					203,
					266,
					234,
					175,
					145,
					162,
					171,
					159,
					149,
					166,
					152,
					154,
					149,
					162,
					167,
					153,
					156,
					151,
					138,
					142,
					153,
					159,
					165,
					159,
					146,
					141,
					149,
					130,
					120,
					120,
					115,
					115,
					97,
					124,
					137,
					135,
					133,
					null,
					null,
					null,
					122,
					123,
					135,
					122,
					111,
					111,
					112,
					106,
					101,
					115,
					107,
					108,
					94,
					100,
					99,
					108,
					90,
					84,
					113,
					114,
					109,
					98,
				],
			};

			// Second chart data (starting from 1/1/1401)
			const chart2Data = {
				goldData: {
					realData: [
						13076000, 13561000, 14390000, 13536000, 12337000, 13212000,
						13493170, 14924440, 17775440, 20360960, 22981100, 26339970,
						25980000, 25648000, 23120000, 22889000, 23166000, 23270000,
						24286000, 24212000, 24672000, 27285000, 28266000, 32975000,
						37650000, 33783000, 33714000, 33610000, 35803000, 37881000,
						43364000, 45026000, 48985000, 52309000, 66000300, 79757000,
						65850000, 64940000, 74027250, 71320000,
					],
					// Scaled data for visualization (divided by 100 to be comparable with stock index)
					scaledData: [
						130760, 135610, 143900, 135360, 123370, 132120, 134932, 149244,
						177754, 203610, 229811, 263400, 259800, 256480, 231200, 228890,
						231660, 232700, 242860, 242120, 246720, 272850, 282660, 329750,
						376500, 337830, 337140, 336100, 358030, 378810, 433640, 450260,
						489850, 523090, 660000, 797570, 658500, 649400, 740270, 713200,
					],
				},
				// Stock index data from 1/1/1401 onwards (from the original data)
				stockIndexData: {
					realData: [
						1512219,
						1582144,
						1533394,
						1473498,
						1431477,
						1355241,
						1296798,
						1407654,
						1496201,
						1657577,
						1594263,
						1960457,
						2324133,
						2318507,
						2173893,
						null,
						null,
						null,
						2032212,
						2022787,
						2211856,
						2166928,
						2070775,
						2195092,
						2201987,
						2112560,
						2043980,
						2172192,
						2037209,
						2097005,
						2007281,
						2257614,
						2501778,
						2849940,
						2719339,
						2709764,
						3077924,
						3108119,
						2984605,
						2843904,
					],
					// Scaled data (already scaled by 10 in original data)
					scaledData: [
						151222,
						158214,
						153339,
						147350,
						143148,
						135524,
						129680,
						140765,
						149620,
						165758,
						159426,
						196046,
						232413,
						231851,
						217389,
						null,
						null,
						null,
						203221,
						202279,
						221186,
						216693,
						207078,
						219509,
						220199,
						211256,
						204398,
						217219,
						203721,
						209701,
						200728,
						225761,
						250178,
						284994,
						271934,
						270976,
						307792,
						310812,
						298461,
						284390,
					],
				},
				// Inflation data from 1/1/1401 onwards
				inflationData: {
					realData: [
						495.1, 520.4, 575.4, 600.4, 614.8, 631, 649.5, 663.5, 679.8, 713.4,
						745.1, 794.3, 834.9, 858.3, 885.8, 908.8, 940.6, 971.6, 995.9,
						1014.8, 1048.3, 1066.1, 1076.8, 1097.3, 1125.8, 1159.6, 1206,
						1242.2, 1277, 1306.4, 1339.1, 1379.3, 1402.7, 1433.6, 1485.2,
						1531.2, 1589.5, 1625.7, 1689.2, 1720.0,
					],
					// Scaled data for visualization (multiplied by 200)
					scaledData: [
						99020, 104080, 115080, 120080, 122960, 126200, 129900, 132700,
						135960, 142680, 149020, 158860, 166980, 171660, 177160, 181760,
						188120, 194320, 199180, 202960, 209660, 213220, 215360, 219460,
						225160, 231920, 241200, 248440, 255400, 261280, 267820, 275860,
						280540, 286720, 297040, 306240, 317900, 325140, 337840, 344000,
					],
				},
				// New data for red color (divided by 3 for scaling)
				newData: {
					realData: [
						342727, 363515, 394145, 417049, 427299, 432169, 437249, 467048,
						480737, 519814, 571444, 652414, 664400, 753200, 783000, 765400,
						757900, 753300, 760600, 757700, 740900, 753900, 784800, 814400,
						816300, 847500, 859100, 874600, 885000, 935200, 966300, 996700,
						1020800, 1050800, 1078100, 1100000, 1124000, 1150000, 1170000,
						1195000,
					],
					// Scaled data for visualization (divided by 3)
					scaledData: [
						114242, 121172, 131382, 139016, 142433, 144056, 145750, 155683,
						160246, 173271, 190481, 217471, 221467, 251067, 261000, 255133,
						252633, 251100, 253533, 252567, 246967, 251300, 261600, 271467,
						272100, 282500, 286367, 291533, 295000, 311733, 322100, 332233,
						340267, 350267, 359367, 366667, 374667, 383333, 390000, 398333,
					],
				},
				labels: [
					'فروردین 1401',
					'اردیبهشت 1401',
					'خرداد 1401',
					'تیر 1401',
					'مرداد 1401',
					'شهریور 1401',
					'مهر 1401',
					'آبان 1401',
					'آذر 1401',
					'دی 1401',
					'بهمن 1401',
					'اسفند 1401',
					'فروردین 1402',
					'اردیبهشت 1402',
					'خرداد 1402',
					'تیر 1402',
					'مرداد 1402',
					'شهریور 1402',
					'مهر 1402',
					'آبان 1402',
					'آذر 1402',
					'دی 1402',
					'بهمن 1402',
					'اسفند 1402',
					'فروردین 1403',
					'اردیبهشت 1403',
					'خرداد 1403',
					'تیر 1403',
					'مرداد 1403',
					'شهریور 1403',
					'مهر 1403',
					'آبان 1403',
					'آذر 1403',
					'دی 1403',
					'بهمن 1403',
					'اسفند 1403',
					'فروردین 1404',
					'اردیبهشت 1404',
					'خرداد 1404',
					'تیر 1404',
				],
			};

			const chartData = {
				type: 'line',
				data: {
					labels: [
						'فروردین 1398',
						'اردیبهشت 1398',
						'خرداد 1398',
						'تیر 1398',
						'مرداد 1398',
						'شهریور 1398',
						'مهر 1398',
						'آبان 1398',
						'آذر 1398',
						'دی 1398',
						'بهمن 1398',
						'اسفند 1398',
						'فروردین 1399',
						'اردیبهشت 1399',
						'خرداد 1399',
						'تیر 1399',
						'مرداد 1399',
						'شهریور 1399',
						'مهر 1399',
						'آبان 1399',
						'آذر 1399',
						'دی 1399',
						'بهمن 1399',
						'اسفند 1399',
						'فروردین 1400',
						'اردیبهشت 1400',
						'خرداد 1400',
						'تیر 1400',
						'مرداد 1400',
						'شهریور 1400',
						'مهر 1400',
						'آبان 1400',
						'آذر 1400',
						'دی 1400',
						'بهمن 1400',
						'اسفند 1400',
						'فروردین 1401',
						'اردیبهشت 1401',
						'خرداد 1401',
						'تیر 1401',
						'مرداد 1401',
						'شهریور 1401',
						'مهر 1401',
						'آبان 1401',
						'آذر 1401',
						'دی 1401',
						'بهمن 1401',
						'اسفند 1401',
						'فروردین 1402',
						'اردیبهشت 1402',
						'خرداد 1402',
						'تیر 1402',
						'مرداد 1402',
						'شهریور 1402',
						'مهر 1402',
						'آبان 1402',
						'آذر 1402',
						'دی 1402',
						'بهمن 1402',
						'اسفند 1402',
						'فروردین 1403',
						'اردیبهشت 1403',
						'خرداد 1403',
						'تیر 1403',
						'مرداد 1403',
						'شهریور 1403',
						'مهر 1403',
						'آبان 1403',
						'آذر 1403',
						'دی 1403',
						'بهمن 1403',
						'اسفند 1403',
						'فروردین 1404',
						'اردیبهشت 1404',
						'خرداد 1404',
						'تیر 1404',
					],
					datasets: [
						{
							label: 'شاخص بورس / 10',
							data: [
								20438, 21517, 23389, 25128, 26613, 31147, 30581, 30500, 35672,
								40601, 47876, 51290, 70899, 98676, 130081, 190117, 172726,
								158121, 141235, 136654, 143639, 118398, 123272, 130766, 120705,
								112816, 118691, 131131, 151589, 138647, 140776, 140713, 135901,
								127945, 127430, 136725, 151222, 158214, 153339, 147350, 143148,
								135524, 129680, 140765, 149620, 165758, 159426, 196046, 232413,
								231851, 217389, 210305, 206763, 204992, 203221, 202279, 221186,
								216693, 207078, 219509, 220199, 211256, 204398, 217219, 203721,
								209700, 200728, 225761, 250178, 284994, 271934, 270976, 307792,
								310812, 298461, 284390,
							],
							borderColor: '#3182ce',
							backgroundColor: 'rgba(49, 130, 206, 0.08)',
							fill: true,
							tension: 0.4,
							borderWidth: 3,
							pointRadius: 0,
							pointHoverRadius: 8,
							pointBackgroundColor: '#3182ce',
							pointBorderColor: '#ffffff',
							pointBorderWidth: 2,
							pointHoverBackgroundColor: '#3182ce',
							pointHoverBorderColor: '#ffffff',
						},
						{
							label: 'ارزش کل بورس (میلیارد ریال) / 1000',
							data: [
								6226, 6554, 7124, 7654, 8107, 9488, 9315, 9291, 10866, 12368,
								14583, 15624, 21597, 30058, 39624, 57912, 52615, 48166, 43022,
								41626, 43754, 36066, 37550, 39833, 36768, 34365, 36155, 39944,
								46176, 42234, 42882, 42863, 41397, 38974, 38817, 41648, 46064,
								48194, 46709, 44885, 43605, 41282, 39502, 42879, 45576, 50492,
								48563, 59718, 70796, 70625, 66220, 64062, 62983, 62443, 61904,
								61617, 67376, 66007, 63078, 66865, 67075, 64351, 62262, 66168,
								62056, 63877, 61144, 68770, 76207, 86813, 82835, 82543, 93758,
								94677, 90915, 86629,
							],
							borderColor: '#e53e3e',
							backgroundColor: 'rgba(229, 62, 62, 0.08)',
							fill: true,
							tension: 0.4,
							borderWidth: 3,
							pointRadius: 0,
							pointHoverRadius: 8,
							pointBackgroundColor: '#e53e3e',
							pointBorderColor: '#ffffff',
							pointBorderWidth: 2,
							pointHoverBackgroundColor: '#e53e3e',
							pointHoverBorderColor: '#ffffff',
						},
						{
							label: 'نرخ دلار (ریال) / 10',
							data: [
								13470, 14235, 13200, 12524, 11600, 11393, 11232, 11794, 13169,
								13439, 14393, 14903, 15442, 17701, 19480, 21800, 22502, 27497,
								29644, 25620, 25604, 22645, 25171, 23963, 24184, 22300, 24259,
								24628, 27666, 27521, 27415, 28440, 30077, 27525, 25417, 26252,
								27862, 30323, 31978, 31883, 29344, 31673, 32812, 35658, 39761,
								43976, 49902, 48101, 51607, 52331, 49731, 48336, 49023, 49393,
								50636, 50199, 50076, 54223, 57036, 60351, 60090, 60560, 61480,
								57611, 58160, 59230, 64855, 68930, 76755, 80670, 91995, 97780,
								82790, 83190, 83535, 88110,
							],
							borderColor: '#38a169',
							backgroundColor: 'rgba(56, 161, 105, 0.08)',
							fill: true,
							tension: 0.4,
							borderWidth: 3,
							pointRadius: 0,
							pointHoverRadius: 8,
							pointBackgroundColor: '#38a169',
							pointBorderColor: '#ffffff',
							pointBorderWidth: 2,
							pointHoverBackgroundColor: '#38a169',
							pointHoverBorderColor: '#ffffff',
						},
						{
							label: 'ارزش کل بورس (میلیارد دلار) × 1000',
							data: [
								46218, 46044, 53973, 61117, 69884, 83278, 82935, 78774, 82513,
								92027, 101324, 104835, 139858, 169809, 203411, 265652, 233822,
								175167, 145129, 162476, 170889, 159265, 149180, 166227, 152035,
								154105, 149036, 162190, 166905, 153459, 156418, 150714, 137637,
								141594, 152720, 158648, 165330, 158936, 146067, 140779, 148598,
								130339, 120389, 120251, 114625, 114817, 97317, 124150, 137183,
								134958, 133156, 127704, 124978, 123615, 122252, 122745, 134547,
								121733, 110594, 110794, 111625, 106260, 101272, 114853, 106699,
								107846, 94279, 99768, 99287, 107615, 90042, 84417, 113247,
								113809, 108835, 98319,
							],
							borderColor: '#d69e2e',
							backgroundColor: 'rgba(214, 158, 46, 0.08)',
							fill: true,
							tension: 0.4,
							borderWidth: 3,
							pointRadius: 0,
							pointHoverRadius: 8,
							pointBackgroundColor: '#d69e2e',
							pointBorderColor: '#ffffff',
							pointBorderWidth: 2,
							pointHoverBackgroundColor: '#d69e2e',
							pointHoverBorderColor: '#ffffff',
						},
					],
				},
				options: {
					responsive: true,
					maintainAspectRatio: false,
					devicePixelRatio: 2,
					backgroundColor: '#FFFFFF',
					interaction: {
						intersect: false,
						mode: 'index',
					},
					plugins: {
						legend: {
							position: 'top',
							labels: {
								color: '#1a202c',
								font: {
									size: 13,
									family: "'IRANSansX', sans-serif",
									weight: '600',
								},
								padding: 20,
								usePointStyle: true,
								pointStyle: 'circle',
								boxWidth: 8,
								boxHeight: 8,
							},
						},
						title: {
							display: false,
						},
						tooltip: {
							backgroundColor: 'rgba(26, 32, 44, 0.95)',
							titleColor: '#ffffff',
							bodyColor: '#ffffff',
							borderColor: '#e2e8f0',
							borderWidth: 1,
							cornerRadius: 8,
							displayColors: true,
							titleFont: {
								size: 14,
								family: "'IRANSansX', sans-serif",
								weight: '600',
							},
							bodyFont: {
								size: 13,
								family: "'IRANSansX', sans-serif",
							},
							padding: 12,
							callbacks: {
								label: function (context) {
									const dataIndex = context.dataIndex;
									const datasetIndex = context.datasetIndex;
									const scaledValue = context.parsed.y;

									// Get real value based on dataset
									let realValue;
									let label;

									switch (datasetIndex) {
										case 0: // Stock Index
											realValue = realData.stockIndex[dataIndex];
											label = 'شاخص بورس';
											break;
										case 1: // Market Value Rial
											realValue = realData.marketValueRial[dataIndex];
											label = 'ارزش کل بورس (میلیارد ریال)';
											break;
										case 2: // Dollar Rate
											realValue = realData.dollarRate[dataIndex];
											label = 'نرخ دلار (ریال)';
											break;
										case 3: // Market Value USD
											realValue = realData.marketValueUSD[dataIndex];
											label = 'ارزش کل بورس (میلیارد دلار)';
											break;
										default:
											return context.dataset.label + ': ' + scaledValue;
									}

									// Format the real value with Persian numbers
									const formattedValue = realValue.toLocaleString('fa-IR');
									return label + ': ' + formattedValue;
								},
							},
						},
					},
					scales: {
						y: {
							type: 'linear',
							position: 'left',
							title: {
								display: true,
								text: 'مقادیر مقیاس‌شده',
								color: '#1a202c',
								font: {
									size: 14,
									family: "'IRANSansX', sans-serif",
									weight: '600',
								},
							},
							min: 0,
							max: 350000,
							grid: {
								color: 'rgba(226, 232, 240, 0.8)',
								borderColor: '#e2e8f0',
								drawBorder: true,
								lineWidth: 1,
								drawTicks: false,
							},
							ticks: {
								color: '#718096',
								font: {
									size: 12,
									family: "'IRANSansX', sans-serif",
									weight: '500',
								},
								padding: 8,
								callback: function (value) {
									return value.toLocaleString('fa-IR');
								},
							},
						},
						x: {
							title: {
								display: true,
								text: 'ماه/سال',
								color: '#1a202c',
								font: {
									size: 14,
									family: "'IRANSansX', sans-serif",
									weight: '600',
								},
							},
							grid: {
								color: 'rgba(226, 232, 240, 0.8)',
								drawBorder: true,
								borderColor: '#e2e8f0',
								lineWidth: 1,
								drawTicks: false,
							},
							ticks: {
								maxRotation: 45,
								minRotation: 45,
								color: '#718096',
								font: {
									size: 10,
									family: "'IRANSansX', sans-serif",
									weight: '500',
								},
								padding: 5,
								maxTicksLimit: 84,
								autoSkip: false,
							},
						},
					},
				},
			};

			// Tab switching function
			function switchTab(tabId) {
				// Hide all chart containers
				document.querySelectorAll('.chart-container').forEach((container) => {
					container.classList.remove('active');
				});

				// Remove active class from all tab buttons
				document.querySelectorAll('.tab-button').forEach((button) => {
					button.classList.remove('active');
				});

				// Show selected chart container
				document.getElementById(tabId).classList.add('active');

				// Add active class to clicked button
				event.target.classList.add('active');

				// Update stat boxes based on active chart
				updateStatBoxes(tabId);
			}

			// Function to update stat boxes based on active chart
			function updateStatBoxes(activeTab) {
				const statCards = document.querySelectorAll('.stat-card');

				if (activeTab === 'chart1') {
					// First chart stats (Financial Indicators) - Fixed colors
					statCards.forEach((card) => {
						card.style.display = 'block';
					});

					statCards[0].querySelector('.stat-value').textContent = '3,108,119';
					statCards[0].querySelector('.stat-value').style.color = '#3182ce'; // Blue
					statCards[0].querySelector('.stat-label').textContent =
						'بالاترین شاخص بورس';

					statCards[1].querySelector('.stat-value').textContent = '94,677,309';
					statCards[1].querySelector('.stat-value').style.color = '#e53e3e'; // Red
					statCards[1].querySelector('.stat-label').textContent =
						'بالاترین ارزش کل بورس (ریال)';

					statCards[2].querySelector('.stat-value').textContent = '977,800';
					statCards[2].querySelector('.stat-value').style.color = '#38a169'; // Green
					statCards[2].querySelector('.stat-label').textContent =
						'بالاترین نرخ دلار (ریال)';

					statCards[3].querySelector('.stat-value').textContent = '266';
					statCards[3].querySelector('.stat-value').style.color = '#d69e2e'; // Yellow
					statCards[3].querySelector('.stat-label').textContent =
						'بالاترین ارزش کل بورس (دلار)';
				} else if (activeTab === 'chart2') {
					// Second chart stats (Percentage changes from 1/1/1401)
					statCards.forEach((card) => {
						card.style.display = 'block';
					});

					statCards[0].querySelector('.stat-value').textContent = '445%+';
					statCards[0].querySelector('.stat-value').style.color = '#fbbf24';
					statCards[0].querySelector('.stat-label').textContent =
						'تغییر قیمت طلا (۱۴۰۱-۱۴۰۴)';

					statCards[1].querySelector('.stat-value').textContent = '88%+';
					statCards[1].querySelector('.stat-value').style.color = '#3182ce';
					statCards[1].querySelector('.stat-label').textContent =
						'تغییر شاخص بورس (۱۴۰۱-۱۴۰۴)';

					statCards[2].querySelector('.stat-value').textContent = '241%+';
					statCards[2].querySelector('.stat-value').style.color = '#38a169';
					statCards[2].querySelector('.stat-label').textContent =
						'تغییر نرخ تورم (۱۴۰۱-۱۴۰۴)';

					statCards[3].querySelector('.stat-value').textContent = '249%+';
					statCards[3].querySelector('.stat-value').style.color = '#e53e3e';
					statCards[3].querySelector('.stat-label').textContent =
						'تغییر قیمت مسکن (۱۴۰۱-۱۴۰۴)';
				} else if (activeTab === 'tables') {
					// Tables tab - hide stat boxes
					statCards.forEach((card) => {
						card.style.display = 'none';
					});
				}
			}

			const ctx = document.getElementById('myChart').getContext('2d');
			new Chart(ctx, chartData);

			// Second chart configuration
			const chart2Config = {
				type: 'line',
				data: {
					labels: chart2Data.labels,
					datasets: [
						{
							label: 'طلای ۱۸ عیار / 100',
							data: chart2Data.goldData.scaledData,
							borderColor: '#fbbf24',
							backgroundColor: 'rgba(251, 191, 36, 0.08)',
							fill: true,
							tension: 0.4,
							borderWidth: 3,
							pointRadius: 0,
							pointHoverRadius: 8,
							pointBackgroundColor: '#fbbf24',
							pointBorderColor: '#ffffff',
							pointBorderWidth: 2,
							pointHoverBackgroundColor: '#fbbf24',
							pointHoverBorderColor: '#ffffff',
							spanGaps: true,
						},
						{
							label: 'شاخص بورس / 10',
							data: chart2Data.stockIndexData.scaledData,
							borderColor: '#3182ce',
							backgroundColor: 'rgba(49, 130, 206, 0.08)',
							fill: true,
							tension: 0.4,
							borderWidth: 3,
							pointRadius: 0,
							pointHoverRadius: 8,
							pointBackgroundColor: '#3182ce',
							pointBorderColor: '#ffffff',
							pointBorderWidth: 2,
							pointHoverBackgroundColor: '#3182ce',
							pointHoverBorderColor: '#ffffff',
							spanGaps: true,
						},
						{
							label: 'تورم × 200',
							data: chart2Data.inflationData.scaledData,
							borderColor: '#38a169',
							backgroundColor: 'rgba(56, 161, 105, 0.08)',
							fill: true,
							tension: 0.4,
							borderWidth: 3,
							pointRadius: 0,
							pointHoverRadius: 8,
							pointBackgroundColor: '#38a169',
							pointBorderColor: '#ffffff',
							pointBorderWidth: 2,
							pointHoverBackgroundColor: '#38a169',
							pointHoverBorderColor: '#ffffff',
							spanGaps: true,
						},
						{
							label: 'قیمت مسکن / 3',
							data: chart2Data.newData.scaledData,
							borderColor: '#e53e3e',
							backgroundColor: 'rgba(229, 62, 62, 0.08)',
							fill: true,
							tension: 0.4,
							borderWidth: 3,
							pointRadius: 0,
							pointHoverRadius: 8,
							pointBackgroundColor: '#e53e3e',
							pointBorderColor: '#ffffff',
							pointBorderWidth: 2,
							pointHoverBackgroundColor: '#e53e3e',
							pointHoverBorderColor: '#ffffff',
							spanGaps: true,
						},
					],
				},
				options: {
					responsive: true,
					maintainAspectRatio: false,
					devicePixelRatio: 2,
					backgroundColor: '#FFFFFF',
					interaction: {
						intersect: false,
						mode: 'index',
					},
					plugins: {
						legend: {
							position: 'top',
							labels: {
								color: '#1a202c',
								font: {
									size: 13,
									family: "'IRANSansX', sans-serif",
									weight: '600',
								},
								padding: 20,
								usePointStyle: true,
								pointStyle: 'circle',
								boxWidth: 8,
								boxHeight: 8,
							},
						},
						title: {
							display: false,
						},
						tooltip: {
							backgroundColor: 'rgba(26, 32, 44, 0.95)',
							titleColor: '#ffffff',
							bodyColor: '#ffffff',
							borderColor: '#e2e8f0',
							borderWidth: 1,
							cornerRadius: 8,
							displayColors: true,
							titleFont: {
								size: 14,
								family: "'IRANSansX', sans-serif",
								weight: '600',
							},
							bodyFont: {
								size: 13,
								family: "'IRANSansX', sans-serif",
							},
							padding: 12,
							callbacks: {
								label: function (context) {
									const dataIndex = context.dataIndex;
									const datasetIndex = context.datasetIndex;

									if (datasetIndex === 0) {
										// Gold data
										const realValue = chart2Data.goldData.realData[dataIndex];
										const formattedValue = realValue.toLocaleString('fa-IR');
										return 'طلای ۱۸ عیار: ' + formattedValue;
									} else if (datasetIndex === 1) {
										// Stock index data
										const realValue =
											chart2Data.stockIndexData.realData[dataIndex];
										if (realValue === null) {
											return 'شاخص بورس: داده موجود نیست';
										}
										const formattedValue = realValue.toLocaleString('fa-IR');
										return 'شاخص بورس: ' + formattedValue;
									} else if (datasetIndex === 2) {
										// Inflation data
										const realValue =
											chart2Data.inflationData.realData[dataIndex];
										const formattedValue = realValue.toLocaleString('fa-IR');
										return 'تورم: ' + formattedValue;
									} else {
										// Housing price data
										const realValue = chart2Data.newData.realData[dataIndex];
										const formattedValue = realValue.toLocaleString('fa-IR');
										return 'قیمت مسکن: ' + formattedValue;
									}
								},
							},
						},
					},
					scales: {
						y: {
							type: 'linear',
							position: 'left',
							title: {
								display: true,
								text: 'مقادیر مقیاس‌شده',
								color: '#1a202c',
								font: {
									size: 14,
									family: "'IRANSansX', sans-serif",
									weight: '600',
								},
							},
							min: 0,
							max: 900000,
							grid: {
								color: 'rgba(226, 232, 240, 0.8)',
								borderColor: '#e2e8f0',
								drawBorder: true,
								lineWidth: 1,
								drawTicks: false,
							},
							ticks: {
								color: '#718096',
								font: {
									size: 12,
									family: "'IRANSansX', sans-serif",
									weight: '500',
								},
								padding: 8,
								callback: function (value) {
									return value.toLocaleString('fa-IR');
								},
							},
						},
						x: {
							title: {
								display: true,
								text: 'ماه/سال',
								color: '#1a202c',
								font: {
									size: 14,
									family: "'IRANSansX', sans-serif",
									weight: '600',
								},
							},
							grid: {
								color: 'rgba(226, 232, 240, 0.8)',
								drawBorder: true,
								borderColor: '#e2e8f0',
								lineWidth: 1,
								drawTicks: false,
							},
							ticks: {
								maxRotation: 45,
								minRotation: 45,
								color: '#718096',
								font: {
									size: 10,
									family: "'IRANSansX', sans-serif",
									weight: '500',
								},
								padding: 5,
								maxTicksLimit: 52,
								autoSkip: false,
							},
						},
					},
				},
			};

			// Initialize second chart
			const ctx2 = document.getElementById('myChart2').getContext('2d');
			new Chart(ctx2, chart2Config);

			// Initialize table data
			populateSubTable('ev-revenue', 'original');

			// Initialize subcategory buttons for the default category
			updateSubcategoryButtons('ev-revenue');

			// Ensure the first table is visible on page load
			document
				.getElementById('ev-revenue-original-table')
				.classList.add('active');

			// Table functions
			function showCategory(category) {
				// Hide all categories
				document.querySelectorAll('.category-content').forEach((content) => {
					content.classList.remove('active');
				});

				// Remove active class from all category buttons
				document.querySelectorAll('.category-btn').forEach((btn) => {
					btn.classList.remove('active');
				});

				// Show selected category
				document.getElementById(category + '-category').classList.add('active');

				// Add active class to clicked button
				event.target.classList.add('active');

				// Update subcategory button onclick handlers
				updateSubcategoryButtons(category);

				// Reset subcategory to first option (جداول اصلی گزارش) and update subcategory buttons
				showSubTable(category, 'original');

				// Ensure the first subcategory button (جداول اصلی گزارش) is active
				const subcategoryButtons =
					document.querySelectorAll('.subcategory-btn');
				subcategoryButtons.forEach((btn, index) => {
					if (index === 0) {
						btn.classList.add('active');
					} else {
						btn.classList.remove('active');
					}
				});
			}

			function updateSubcategoryButtons(category) {
				const subcategoryButtons =
					document.querySelectorAll('.subcategory-btn');
				subcategoryButtons[0].onclick = () =>
					showSubTable(category, 'original');
				subcategoryButtons[1].onclick = () =>
					showSubTable(category, 'corrected');
				subcategoryButtons[2].onclick = () => showSubTable(category, '2022');
				subcategoryButtons[3].onclick = () => showSubTable(category, 'custom');
			}

			function showSubTable(category, subType) {
				// First, hide all sub-tables across ALL categories
				document.querySelectorAll('.sub-table').forEach((table) => {
					table.classList.remove('active');
				});

				// Remove active class from ALL subcategory buttons across ALL categories
				document.querySelectorAll('.subcategory-btn').forEach((btn) => {
					btn.classList.remove('active');
				});

				// Show selected sub-table
				document
					.getElementById(category + '-' + subType + '-table')
					.classList.add('active');

				// Add active class to clicked button
				event.target.classList.add('active');

				// Populate table data
				populateSubTable(category, subType);
			}

			function populateSubTable(category, subType) {
				// Sample data - replace with actual data
				const sampleData = {
					'ev-revenue': {
						corrected: [
							{
								description:
									'درآمد عملیاتی سال ۱۴۰۳ - ارائه شده توسط شرکت طبق صورتهای مالی حسابرسی نشده',
								amount: 31579776,
								unit: 'میلیون ریال',
							},
							{
								description: 'افزایش ۵۰ درصدی طبق روند سنوات گذشته',
								amount: 15789888,
								unit: 'میلیون ریال',
							},
							{
								description: 'درآمد عملیاتی پیش بینی سال ۱۴۰۴',
								amount: 47369664,
								unit: 'میلیون ریال',
							},
							{
								description: 'متوسط نسبت EV/Revenue شرکتهای مشابه بین المللی',
								amount: 4.6,
								unit: '',
							},
							{
								description:
									'جمع كل ارزش شرکت فناوری ایده پرداز صبا (بدون محاسبه ارزش برند و سایر امتیازات)',
								amount: 217900454,
								unit: 'میلیون ریال',
							},
							{
								description:
									'ارزش تلویحى فيليمو - ۸۰ درصد ارزش شرکت فناوری ایده پرداز صبا',
								amount: 174320364,
								unit: 'میلیون ریال',
							},
							{
								description:
									'ارزش سهام پلتفرم فیلیمو خارج از بورس - تعدیل با تخفیف ۱۸ درصد عدم نقدشوندگی (DLOM) نسبت به بازار بورس ایران',
								amount: 142942698,
								unit: 'میلیون ریال',
							},
							{
								description: 'تفاوت ارزش پلتفرم فیلیمو در صورت ورود به بورس',
								amount: 31377665,
								unit: 'میلیون ریال',
							},
							{
								description:
									'خسارت وارد شده به سهامدار ۱۲ درصدی - آقای مهدی رضوی',
								amount: 3765320,
								unit: 'میلیون ریال',
							},
						],
						original: [
							{
								description: 'درآمد عملیاتی پیش بینی سال ۱۴۰۴',
								amount: 47369664,
								unit: 'میلیون ریال',
							},
							{
								description: 'متوسط نسبت EV/Revenue شرکتهای مشابه بین المللی',
								amount: 5,
								unit: '',
							},
							{
								description: 'جمع كل ارزش شرکت فناوری ایده پرداز صبا',
								amount: 236848320,
								unit: 'میلیون ریال',
							},
							{
								description:
									'ارزش تلویحی فیلیمو - ۸۰ درصد ارزش شرکت فناوری ایده پرداز صبا',
								amount: 189478656,
								unit: 'میلیون ریال',
							},
							{
								description:
									'ارزش سهام پلتفرم فیلیمو خارج از بورس - تعدیل با تخفیف ۱۸ درصد عدم نقدشوندگی (DLOM) نسبت به بازار بورس ایران',
								amount: 155372498,
								unit: 'میلیون ریال',
							},
							{
								description: 'تفاوت ارزش پلتفرم فیلیمو در صورت ورود به بورس',
								amount: 34106158,
								unit: 'میلیون ریال',
							},
							{
								description:
									'خسارت وارد شده به سهامدار ۱۲ درصدی - آقای مهدی رضوی',
								amount: 4092739,
								unit: 'میلیون ریال',
							},
						],
						2022: [
							{
								description: 'درآمد عملیاتی سال ۱۴۰۰',
								amount: 7305556,
								unit: 'میلیون ریال',
							},
							{
								description:
									'متوسط نسبت EV/Revenue شرکتهای مشابه بين المللي (2022)',
								amount: 3,
								unit: '',
							},
							{
								description: 'جمع كل ارزش شرکت فناوری ایده پرداز صبا',
								amount: 21916668,
								unit: 'میلیون ریال',
							},
							{
								description:
									'ارزش تلویحی فیلیمو - ۸۰ درصد ارزش شرکت فناوری ایده پرداز صبا',
								amount: 17533334,
								unit: 'میلیون ریال',
							},
							{
								description:
									'ارزش سهام پلتفرم فیلیمو خارج از بورس - تعدیل با تخفیف ۱۸ درصد عدم نقد شوندگی (DLOM) نسبت به بازار بورس ایران',
								amount: 14377334,
								unit: 'میلیون ریال',
							},
							{
								description: 'تفاوت ارزش پلتفرم فیلیمو در صورت ورود به بورس',
								amount: 3156000,
								unit: 'میلیون ریال',
							},
							{
								description:
									'خسارت وارد شده به سهامدار ۱۲ درصدی - آقای مهدی رضوی',
								amount: 378720,
								unit: 'میلیون ریال',
							},
						],
						custom: [
							{
								description:
									'درآمد عملیاتی سال ۱۴۰۳ - ارائه شده توسط شرکت طبق صورتهای مالی حسابرسی نشده',
								amount: 31579776,
								unit: 'میلیون ریال',
							},
							{
								description: 'افزایش ۵۰ درصدی طبق روند سنوات گذشته',
								amount: 15789888,
								unit: 'میلیون ریال',
							},
							{
								description: 'درآمد عملیاتی پیش بینی سال ۱۴۰۴',
								amount: 47369664,
								unit: 'میلیون ریال',
							},
							{
								description: 'متوسط نسبت EV/Revenue شرکتهای مشابه بین المللی',
								amount: 1.88,
								unit: '',
							},
							{
								description:
									'جمع كل ارزش شرکت فناوری ایده پرداز صبا بدون محاسبه ارزش برند و سایر امتیازات',
								amount: 89054732,
								unit: 'میلیون ریال',
							},
							{
								description:
									'ارزش تلویحی فیلیمو - ۸۰ درصد ارزش شرکت فناوری ایده پرداز صبا',
								amount: 71243975,
								unit: 'میلیون ریال',
							},
							{
								description:
									'ارزش سهام پلتفرم فیلیمو خارج از بورس - تعدیل با تخفیف ۱۸ درصد عدم نقدشوندگی (DLOM) نسبت به بازار بورس ایران',
								amount: 58420059,
								unit: 'میلیون ریال',
							},
							{
								description: 'تفاوت ارزش پلتفرم فیلیمو در صورت ورود به بورس',
								amount: 12823915,
								unit: 'میلیون ریال',
							},
							{
								description:
									'خسارت وارد شده به سهامدار ۱۲ درصدی - آقای مهدی رضوی',
								amount: 1538870,
								unit: 'میلیون ریال',
							},
						],
					},
					pe: {
						corrected: [
							{
								description:
									'متوسط سود خالص پس از کسر مالیات در سنوات ۱۴۰۳ و ۱۴۰۴',
								amount: 8780351,
								unit: 'میلیون ریال',
							},
							{
								description:
									'متوسط P/E شرکتهای مشابه بین المللی با تعدیل نرخ بهره',
								amount: 25,
								unit: '',
							},
							{
								description:
									'جمع كل ارزش شرکت فناوران ایده پرداز صبا (بدون محاسبه ارزش برند و سایر امتیازات)',
								amount: 219508775,
								unit: 'میلیون ریال',
							},
							{
								description:
									'ارزش پلتفرم فیلیمو - ۸۰ درصد ارزش شرکت فناوران ایده پرداز صبا',
								amount: 175607020,
								unit: 'میلیون ریال',
							},
							{
								description:
									'ارزش سهام فیلیمو خارج از بورس - تعدیل با تخفیف ۱۸ درصد نقدشوندگی',
								amount: 143997756,
								unit: 'میلیون ریال',
							},
							{
								description: 'تفاوت ارزش پلتفرم فیلیمو در صورت ورود به بورس',
								amount: 31609264,
								unit: 'میلیون ریال',
							},
							{
								description: 'خسارت وارد به سهامدار ۱۲ درصدی - آقای مهداد رضوی',
								amount: 3793112,
								unit: 'میلیون ریال',
							},
						],
						original: [
							{
								description:
									'متوسط سود خالص پس از کسر مالیات در سنوات ۱۴۰۳ و ۱۴۰۴',
								amount: 8780351,
								unit: 'میلیون ریال',
							},
							{
								description:
									'متوسط P/E شرکتهای مشابه بین المللی با تعدیل نرخ بهره',
								amount: 30,
								unit: '',
							},
							{
								description:
									'جمع كل ارزش شرکت فناوران ایده پرداز صبا (بدون محاسبه ارزش برند و سایر امتیازات)',
								amount: 263410530,
								unit: 'میلیون ریال',
							},
							{
								description:
									'ارزش پلتفرم فیلیمو - ۸۰ درصد ارزش شرکت فناوران ایده پرداز صبا',
								amount: 210728424,
								unit: 'میلیون ریال',
							},
							{
								description:
									'ارزش سهام فیلیمو خارج از بورس - تعدیل با تخفیف ۱۸ درصد نقدشوندگی',
								amount: 172797308,
								unit: 'میلیون ریال',
							},
							{
								description: 'تفاوت ارزش پلتفرم فیلیمو در صورت ورود به بورس',
								amount: 37931116,
								unit: 'میلیون ریال',
							},
							{
								description: 'خسارت وارد به سهامدار ۱۲ درصدی - آقای مهداد رضوی',
								amount: 4551734,
								unit: 'میلیون ریال',
							},
						],
						2022: [
							{
								description: 'سود خالص پس از کسر مالیات در سال ۱۴۰۰',
								amount: 1434749,
								unit: 'میلیون ریال',
							},
							{
								description: 'متوسط P/E شرکتهای مشابه بین المللی (2022)',
								amount: 27.5,
								unit: '',
							},
							{
								description: 'جمع كل ارزش شرکت فناوران ایده پرداز صبا',
								amount: 39455598,
								unit: 'میلیون ریال',
							},
							{
								description:
									'ارزش پلتفرم فیلیمو - ۸۰ درصد ارزش شرکت فناوران ایده پرداز صبا',
								amount: 31564478,
								unit: 'میلیون ریال',
							},
							{
								description:
									'ارزش سهام فیلیمو خارج از بورس - تعدیل با تخفیف ۱۸ درصد نقدشوندگی',
								amount: 25882872,
								unit: 'میلیون ریال',
							},
							{
								description: 'تفاوت ارزش پلتفرم فیلیمو در صورت ورود به بورس',
								amount: 5681606,
								unit: 'میلیون ریال',
							},
							{
								description: 'خسارت وارد به سهامدار ۱۲ درصدی - آقای مهداد رضوی',
								amount: 681793,
								unit: 'میلیون ریال',
							},
						],
						custom: [
							{
								description:
									'متوسط سود خالص پس از کسر مالیات در سنوات ۱۴۰۳ و ۱۴۰۴',
								amount: 8780351,
								unit: 'میلیون ریال',
							},
							{
								description:
									'متوسط P/E شرکتهای مشابه بین المللی با تعدیل نرخ بهره',
								amount: 10.76,
								unit: '',
							},
							{
								description:
									'جمع كل ارزش شرکت فناوران ایده پرداز صبا بدون محاسبه ارزش برند و سایر امتیازات',
								amount: 94476577,
								unit: 'میلیون ریال',
							},
							{
								description:
									'ارزش پلتفرم فیلیمو - ۸۰ درصد ارزش شرکت فناوران ایده پرداز صبا',
								amount: 75581261,
								unit: 'میلیون ریال',
							},
							{
								description:
									'ارزش سهام فیلیمو خارج از بورس - تعدیل با تخفیف ۱۸ درصد نقدشوندگی',
								amount: 61976634,
								unit: 'میلیون ریال',
							},
							{
								description: 'تفاوت ارزش پلتفرم فیلیمو در صورت ورود به بورس',
								amount: 13604627,
								unit: 'میلیون ریال',
							},
							{
								description: 'خسارت وارد به سهامدار ۱۲ درصدی - آقای مهداد رضوی',
								amount: 1632555,
								unit: 'میلیون ریال',
							},
						],
					},
				};

				const tbody = document.getElementById(
					category + '-' + subType + '-body'
				);
				tbody.innerHTML = '';

				const data = sampleData[category][subType];
				const ratioColumn = category === 'ev-revenue' ? 'EV/Revenue' : 'P/E';

				data.forEach((item, index) => {
					const row = document.createElement('tr');

					// Check if this is a financial data table structure (2022, original, corrected, custom, etc.)
					if (
						subType === '2022' ||
						(category === 'pe' && subType === 'original') ||
						(category === 'pe' && subType === 'corrected') ||
						(category === 'pe' && subType === 'custom') ||
						(category === 'ev-revenue' && subType === 'original') ||
						(category === 'ev-revenue' && subType === 'corrected') ||
						(category === 'ev-revenue' && subType === 'custom')
					) {
						row.innerHTML = `
							<td>${index + 1}</td>
							<td>${item.description}</td>
							<td>${item.amount.toLocaleString('fa-IR')}</td>
						`;
					} else {
						// Standard company/ratio structure with enhanced status styling
						const statusClass = getStatusClass(item.status);
						const changeClass = getChangeClass(item.change);

						row.innerHTML = `
							<td>${item.company}</td>
							<td>${item.ratio}</td>
							<td class="${changeClass}">${item.change}</td>
							<td class="${statusClass}">${item.status}</td>
						`;
					}

					tbody.appendChild(row);
				});
			}

			// Helper functions for status and change styling
			function getStatusClass(status) {
				switch (status) {
					case 'بهبود':
						return 'status-improved';
					case 'کاهش':
						return 'status-decreased';
					case 'ثابت':
						return 'status-stable';
					default:
						return '';
				}
			}

			function getChangeClass(change) {
				if (change.startsWith('+')) {
					return 'change-positive';
				} else if (change.startsWith('-')) {
					return 'change-negative';
				} else {
					return 'change-neutral';
				}
			}
		</script>
	</body>
</html>
