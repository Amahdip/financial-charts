<!DOCTYPE html>
<html lang="fa" dir="rtl">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>روند داده‌های مقیاس‌شده - Iran Macro</title>
		<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
		<link rel="stylesheet" href="styles.css" />
	</head>
	<body>
		<div class="container">
			<h1>روند داده‌های مقیاس‌شده</h1>
			<div class="subtitle">تحلیل جامع شاخص‌های مالی (1398 تا 1404)</div>

			<!-- Tab Navigation -->
			<div class="tab-navigation">
				<button class="tab-button active" onclick="switchTab('chart1')">
					شاخص‌های مالی
				</button>
				<button class="tab-button" onclick="switchTab('chart2')">
					شاخص‌های جایگزین
				</button>
				<button class="tab-button" onclick="switchTab('tables')">جداول</button>
				<button class="tab-button" onclick="switchTab('comparison')">
					مقایسه شرکت‌ها
				</button>
			</div>

			<div class="stats-grid">
				<div class="stat-card">
					<div class="stat-value" style="color: #3182ce">3,108,119</div>
					<div class="stat-label">بالاترین شاخص بورس</div>
				</div>
				<div class="stat-card">
					<div class="stat-value" style="color: #e53e3e">94,677,309</div>
					<div class="stat-label">بالاترین ارزش کل بورس (ریال)</div>
				</div>
				<div class="stat-card">
					<div class="stat-value" style="color: #38a169">977,800</div>
					<div class="stat-label">بالاترین نرخ دلار (ریال)</div>
				</div>
				<div class="stat-card">
					<div class="stat-value" style="color: #d69e2e">266</div>
					<div class="stat-label">بالاترین ارزش کل بورس (دلار)</div>
				</div>
			</div>

			<!-- Chart Containers -->
			<div id="chart1" class="chart-container active">
				<canvas id="myChart"></canvas>
			</div>

			<div id="chart2" class="chart-container">
				<canvas id="myChart2"></canvas>
			</div>

			<div id="tables" class="chart-container">
				<div class="tables-content">
					<div class="table-layout">
						<div class="table-section">
							<!-- EV/Revenue Category -->
							<div id="ev-revenue-category" class="category-content active">
								<div id="ev-revenue-original-table" class="sub-table active">
									<div class="table-container">
										<table>
											<thead>
												<tr>
													<th>ردیف</th>
													<th>شرح</th>
													<th>مبلغ (میلیون ریال)</th>
												</tr>
											</thead>
											<tbody id="ev-revenue-original-body">
												<!-- Data will be populated by JavaScript -->
											</tbody>
										</table>
									</div>
								</div>

								<div id="ev-revenue-corrected-table" class="sub-table">
									<div class="table-container">
										<table>
											<thead>
												<tr>
													<th>ردیف</th>
													<th>شرح</th>
													<th>مبلغ (میلیون ریال)</th>
												</tr>
											</thead>
											<tbody id="ev-revenue-corrected-body">
												<!-- Data will be populated by JavaScript -->
											</tbody>
										</table>
									</div>
								</div>

								<div id="ev-revenue-2022-table" class="sub-table">
									<div class="table-container">
										<table>
											<thead>
												<tr>
													<th>ردیف</th>
													<th>شرح</th>
													<th>مبلغ (میلیون ریال)</th>
												</tr>
											</thead>
											<tbody id="ev-revenue-2022-body">
												<!-- Data will be populated by JavaScript -->
											</tbody>
										</table>
									</div>
								</div>

								<div id="ev-revenue-custom-table" class="sub-table">
									<div class="table-container">
										<table>
											<thead>
												<tr>
													<th>ردیف</th>
													<th>شرح</th>
													<th>مبلغ (میلیون ریال)</th>
												</tr>
											</thead>
											<tbody id="ev-revenue-custom-body">
												<!-- Data will be populated by JavaScript -->
											</tbody>
										</table>
									</div>
								</div>
							</div>

							<!-- P/E Category -->
							<div id="pe-category" class="category-content">
								<div id="pe-original-table" class="sub-table active">
									<div class="table-container">
										<table>
											<thead>
												<tr>
													<th>ردیف</th>
													<th>شرح</th>
													<th>مبلغ (میلیون ریال)</th>
												</tr>
											</thead>
											<tbody id="pe-original-body">
												<!-- Data will be populated by JavaScript -->
											</tbody>
										</table>
									</div>
								</div>

								<div id="pe-corrected-table" class="sub-table">
									<div class="table-container">
										<table>
											<thead>
												<tr>
													<th>ردیف</th>
													<th>شرح</th>
													<th>مبلغ (میلیون ریال)</th>
												</tr>
											</thead>
											<tbody id="pe-corrected-body">
												<!-- Data will be populated by JavaScript -->
											</tbody>
										</table>
									</div>
								</div>

								<div id="pe-2022-table" class="sub-table">
									<div class="table-container">
										<table>
											<thead>
												<tr>
													<th>ردیف</th>
													<th>شرح</th>
													<th>مبلغ (میلیون ریال)</th>
												</tr>
											</thead>
											<tbody id="pe-2022-body">
												<!-- Data will be populated by JavaScript -->
											</tbody>
										</table>
									</div>
								</div>

								<div id="pe-custom-table" class="sub-table">
									<div class="table-container">
										<table>
											<thead>
												<tr>
													<th>ردیف</th>
													<th>شرح</th>
													<th>مبلغ (میلیون ریال)</th>
												</tr>
											</thead>
											<tbody id="pe-custom-body">
												<!-- Data will be populated by JavaScript -->
											</tbody>
										</table>
									</div>
								</div>
							</div>
						</div>

						<div class="controls-section">
							<div class="category-controls">
								<button
									class="category-btn active"
									onclick="showCategory('ev-revenue')"
								>
									EV/Revenue
								</button>
								<button class="category-btn" onclick="showCategory('pe')">
									P/E
								</button>
							</div>

							<div class="subcategory-controls">
								<button
									class="subcategory-btn active"
									onclick="showSubTable('ev-revenue', 'original')"
								>
									جداول اصلی گزارش
								</button>
								<button
									class="subcategory-btn"
									onclick="showSubTable('ev-revenue', 'corrected')"
								>
									جداول اصلی گزارش با نسبت‌های صحیح
								</button>
								<button
									class="subcategory-btn"
									onclick="showSubTable('ev-revenue', '2022')"
								>
									جداول گزارش در پایان سال ۱۴۰۱
								</button>
								<button
									class="subcategory-btn"
									onclick="showSubTable('ev-revenue', 'custom')"
								>
									جداول با شرکت‌های متناسب
								</button>
							</div>
						</div>
					</div>
				</div>
			</div>

			<div id="comparison" class="chart-container">
				<div class="sub-tab-navigation">
					<button
						class="sub-tab-button active"
						onclick="switchComparisonSubTab('evaluator-pe-tab')"
					>
						شرکت‌های متناسب - P/E
					</button>
					<button
						class="sub-tab-button"
						onclick="switchComparisonSubTab('our-pe-tab')"
					>
						شرکت‌های انتخاب شده توسط کارشناسان - P/E
					</button>
					<button
						class="sub-tab-button"
						onclick="switchComparisonSubTab('evaluator-ev-tab')"
					>
						شرکت‌های متناسب - EV/Revenue
					</button>
					<button
						class="sub-tab-button"
						onclick="switchComparisonSubTab('our-ev-tab')"
					>
						شرکت‌های انتخاب شده توسط کارشناسان - EV/Revenue
					</button>
				</div>

				<div id="evaluator-pe-tab" class="comparison-sub-table active">
					<div class="table-container">
						<table>
							<thead>
								<tr>
									<th>ردیف</th>
									<th>شرکت</th>
									<th>نماد</th>
									<th>سرویس</th>
									<th>Forward P/E (FY25)</th>
								</tr>
							</thead>
							<tbody id="evaluator-companies-body">
								<!-- Data will be populated by JavaScript -->
							</tbody>
						</table>
					</div>
				</div>

				<div id="our-pe-tab" class="comparison-sub-table">
					<div class="table-container">
						<table>
							<thead>
								<tr>
									<th>ردیف</th>
									<th>برند</th>
									<th>شرکت مادر</th>
									<th>وضعیت بورسی مستقل</th>
									<th>P/E مستقل؟</th>
									<th>P/E ادعایی در گزارش</th>
									<th>توضیحات</th>
								</tr>
							</thead>
							<tbody id="our-companies-body">
								<!-- Data will be populated by JavaScript -->
							</tbody>
						</table>
					</div>
				</div>

				<div id="evaluator-ev-tab" class="comparison-sub-table">
					<div class="table-container">
						<table>
							<thead>
								<tr>
									<th>ردیف</th>
									<th>شرکت</th>
									<th>نماد</th>
									<th>سرویس</th>
									<th>EV/Revenue</th>
								</tr>
							</thead>
							<tbody id="evaluator-ev-revenue-body">
								<!-- Data will be populated by JavaScript -->
							</tbody>
						</table>
					</div>
				</div>

				<div id="our-ev-tab" class="comparison-sub-table">
					<div class="table-container">
						<table>
							<thead>
								<tr>
									<th>ردیف</th>
									<th>شرکت</th>
									<th>2024 (EV/Revenue) ادعایی در گزارش</th>
									<th>2025 (پیش بینی)</th>
								</tr>
							</thead>
							<tbody id="our-ev-revenue-body">
								<!-- Data will be populated by JavaScript -->
							</tbody>
						</table>
					</div>
				</div>
			</div>
		</div>

		<script>
			// Real data arrays for tooltips (unscaled values)
			const realData = {
				stockIndex: [
					204375,
					215168,
					233886,
					251278,
					266127,
					311471,
					305807,
					304997,
					356721,
					406008,
					478755,
					512900,
					708995,
					986759,
					1300813,
					1901169,
					1727265,
					1581206,
					1412355,
					1366535,
					1436393,
					1183978,
					1232716,
					1307657,
					1207047,
					1128164,
					1186906,
					1311306,
					1515887,
					1386466,
					1407758,
					1407133,
					1359011,
					1279450,
					1274305,
					1367250,
					1512219,
					1582144,
					1533394,
					1473498,
					1431477,
					1355241,
					1296798,
					1407654,
					1496201,
					1657577,
					1594263,
					1960457,
					2324133,
					2318507,
					2173893,
					null,
					null,
					null,
					2032212,
					2022787,
					2211856,
					2166928,
					2070775,
					2195092,
					2201987,
					2112560,
					2043980,
					2172192,
					2037209,
					2097005,
					2007281,
					2257614,
					2501778,
					2849940,
					2719339,
					2709764,
					3077924,
					3108119,
					2984605,
					2843904,
				],
				marketValueRial: [
					6225526,
					6554295,
					7124469,
					7654252,
					8106571,
					9487808,
					9315275,
					9290602,
					10866181,
					12367527,
					14583494,
					15623595,
					21596889,
					30057957,
					39624433,
					57912068,
					52614714,
					48165581,
					43022143,
					41626423,
					43754378,
					36065501,
					37550121,
					39832929,
					36768204,
					34365332,
					36154671,
					39944070,
					46175856,
					42233550,
					42882122,
					42863081,
					41397226,
					38973689,
					38816963,
					41648206,
					46064142,
					48194139,
					46709154,
					44884651,
					43604640,
					41282384,
					39502132,
					42878958,
					45576204,
					50491922,
					48563302,
					59718058,
					70796076,
					70624695,
					66219594,
					null,
					null,
					null,
					61903799,
					61616690,
					67375993,
					66007414,
					63078484,
					66865340,
					67075358,
					64351309,
					62262277,
					66167770,
					62056008,
					63877460,
					61144372,
					68769824,
					76207371,
					86812850,
					82834562,
					82542906,
					93757528,
					94677309,
					90914927,
					86628981,
				],
				dollarRate: [
					134700, 142350, 132000, 125240, 116000, 113930, 112320, 117940,
					131690, 134390, 143930, 149030, 154420, 177010, 194800, 218000,
					225020, 274970, 296440, 256200, 256040, 226450, 251710, 239630,
					241840, 223000, 242590, 246280, 276660, 275210, 274150, 284400,
					300770, 275250, 254170, 262520, 278620, 303230, 319780, 318830,
					293440, 316730, 328120, 356580, 397610, 439761, 499020, 481014,
					516069, 523310, 497310, 483360, 490230, 493930, 506362, 501990,
					500760, 542230, 570360, 603510, 600900, 605600, 614800, 576110,
					581600, 592300, 648550, 689300, 767550, 806700, 919950, 977800,
					827900, 831900, 835350, 881100,
				],
				marketValueUSD: [
					46,
					46,
					54,
					61,
					70,
					83,
					83,
					79,
					83,
					92,
					101,
					105,
					140,
					170,
					203,
					266,
					234,
					175,
					145,
					162,
					171,
					159,
					149,
					166,
					152,
					154,
					149,
					162,
					167,
					153,
					156,
					151,
					138,
					142,
					153,
					159,
					165,
					159,
					146,
					141,
					149,
					130,
					120,
					120,
					115,
					115,
					97,
					124,
					137,
					135,
					133,
					null,
					null,
					null,
					122,
					123,
					135,
					122,
					111,
					111,
					112,
					106,
					101,
					115,
					107,
					108,
					94,
					100,
					99,
					108,
					90,
					84,
					113,
					114,
					109,
					98,
				],
			};

			// Second chart data (starting from 1/1/1401)
			const chart2Data = {
				goldData: {
					realData: [
						13076000, 13561000, 14390000, 13536000, 12337000, 13212000,
						13493170, 14924440, 17775440, 20360960, 22981100, 26339970,
						25980000, 25648000, 23120000, 22889000, 23166000, 23270000,
						24286000, 24212000, 24672000, 27285000, 28266000, 32975000,
						37650000, 33783000, 33714000, 33610000, 35803000, 37881000,
						43364000, 45026000, 48985000, 52309000, 66000300, 79757000,
						65850000, 64940000, 74027250, 71320000,
					],
					// Scaled data for visualization (divided by 100 to be comparable with stock index)
					scaledData: [
						130760, 135610, 143900, 135360, 123370, 132120, 134932, 149244,
						177754, 203610, 229811, 263400, 259800, 256480, 231200, 228890,
						231660, 232700, 242860, 242120, 246720, 272850, 282660, 329750,
						376500, 337830, 337140, 336100, 358030, 378810, 433640, 450260,
						489850, 523090, 660000, 797570, 658500, 649400, 740270, 713200,
					],
				},
				// Stock index data from 1/1/1401 onwards (from the original data)
				stockIndexData: {
					realData: [
						1512219,
						1582144,
						1533394,
						1473498,
						1431477,
						1355241,
						1296798,
						1407654,
						1496201,
						1657577,
						1594263,
						1960457,
						2324133,
						2318507,
						2173893,
						null,
						null,
						null,
						2032212,
						2022787,
						2211856,
						2166928,
						2070775,
						2195092,
						2201987,
						2112560,
						2043980,
						2172192,
						2037209,
						2097005,
						2007281,
						2257614,
						2501778,
						2849940,
						2719339,
						2709764,
						3077924,
						3108119,
						2984605,
						2843904,
					],
					// Scaled data (already scaled by 10 in original data)
					scaledData: [
						151222,
						158214,
						153339,
						147350,
						143148,
						135524,
						129680,
						140765,
						149620,
						165758,
						159426,
						196046,
						232413,
						231851,
						217389,
						null,
						null,
						null,
						203221,
						202279,
						221186,
						216693,
						207078,
						219509,
						220199,
						211256,
						204398,
						217219,
						203721,
						209701,
						200728,
						225761,
						250178,
						284994,
						271934,
						270976,
						307792,
						310812,
						298461,
						284390,
					],
				},
				// Inflation data from 1/1/1401 onwards
				inflationData: {
					realData: [
						495.1, 520.4, 575.4, 600.4, 614.8, 631, 649.5, 663.5, 679.8, 713.4,
						745.1, 794.3, 834.9, 858.3, 885.8, 908.8, 940.6, 971.6, 995.9,
						1014.8, 1048.3, 1066.1, 1076.8, 1097.3, 1125.8, 1159.6, 1206,
						1242.2, 1277, 1306.4, 1339.1, 1379.3, 1402.7, 1433.6, 1485.2,
						1531.2, 1589.5, 1625.7, 1689.2, 1720.0,
					],
					// Scaled data for visualization (multiplied by 200)
					scaledData: [
						99020, 104080, 115080, 120080, 122960, 126200, 129900, 132700,
						135960, 142680, 149020, 158860, 166980, 171660, 177160, 181760,
						188120, 194320, 199180, 202960, 209660, 213220, 215360, 219460,
						225160, 231920, 241200, 248440, 255400, 261280, 267820, 275860,
						280540, 286720, 297040, 306240, 317900, 325140, 337840, 344000,
					],
				},
				// New data for red color (divided by 3 for scaling)
				newData: {
					realData: [
						342727, 363515, 394145, 417049, 427299, 432169, 437249, 467048,
						480737, 519814, 571444, 652414, 664400, 753200, 783000, 765400,
						757900, 753300, 760600, 757700, 740900, 753900, 784800, 814400,
						816300, 847500, 859100, 874600, 885000, 935200, 966300, 996700,
						1020800, 1050800, 1078100, 1100000, 1124000, 1150000, 1170000,
						1195000,
					],
					// Scaled data for visualization (divided by 3)
					scaledData: [
						114242, 121172, 131382, 139016, 142433, 144056, 145750, 155683,
						160246, 173271, 190481, 217471, 221467, 251067, 261000, 255133,
						252633, 251100, 253533, 252567, 246967, 251300, 261600, 271467,
						272100, 282500, 286367, 291533, 295000, 311733, 322100, 332233,
						340267, 350267, 359367, 366667, 374667, 383333, 390000, 398333,
					],
				},
				labels: [
					'فروردین 1401',
					'اردیبهشت 1401',
					'خرداد 1401',
					'تیر 1401',
					'مرداد 1401',
					'شهریور 1401',
					'مهر 1401',
					'آبان 1401',
					'آذر 1401',
					'دی 1401',
					'بهمن 1401',
					'اسفند 1401',
					'فروردین 1402',
					'اردیبهشت 1402',
					'خرداد 1402',
					'تیر 1402',
					'مرداد 1402',
					'شهریور 1402',
					'مهر 1402',
					'آبان 1402',
					'آذر 1402',
					'دی 1402',
					'بهمن 1402',
					'اسفند 1402',
					'فروردین 1403',
					'اردیبهشت 1403',
					'خرداد 1403',
					'تیر 1403',
					'مرداد 1403',
					'شهریور 1403',
					'مهر 1403',
					'آبان 1403',
					'آذر 1403',
					'دی 1403',
					'بهمن 1403',
					'اسفند 1403',
					'فروردین 1404',
					'اردیبهشت 1404',
					'خرداد 1404',
					'تیر 1404',
				],
			};

			const chartData = {
				type: 'line',
				data: {
					labels: [
						'فروردین 1398',
						'اردیبهشت 1398',
						'خرداد 1398',
						'تیر 1398',
						'مرداد 1398',
						'شهریور 1398',
						'مهر 1398',
						'آبان 1398',
						'آذر 1398',
						'دی 1398',
						'بهمن 1398',
						'اسفند 1398',
						'فروردین 1399',
						'اردیبهشت 1399',
						'خرداد 1399',
						'تیر 1399',
						'مرداد 1399',
						'شهریور 1399',
						'مهر 1399',
						'آبان 1399',
						'آذر 1399',
						'دی 1399',
						'بهمن 1399',
						'اسفند 1399',
						'فروردین 1400',
						'اردیبهشت 1400',
						'خرداد 1400',
						'تیر 1400',
						'مرداد 1400',
						'شهریور 1400',
						'مهر 1400',
						'آبان 1400',
						'آذر 1400',
						'دی 1400',
						'بهمن 1400',
						'اسفند 1400',
						'فروردین 1401',
						'اردیبهشت 1401',
						'خرداد 1401',
						'تیر 1401',
						'مرداد 1401',
						'شهریور 1401',
						'مهر 1401',
						'آبان 1401',
						'آذر 1401',
						'دی 1401',
						'بهمن 1401',
						'اسفند 1401',
						'فروردین 1402',
						'اردیبهشت 1402',
						'خرداد 1402',
						'تیر 1402',
						'مرداد 1402',
						'شهریور 1402',
						'مهر 1402',
						'آبان 1402',
						'آذر 1402',
						'دی 1402',
						'بهمن 1402',
						'اسفند 1402',
						'فروردین 1403',
						'اردیبهشت 1403',
						'خرداد 1403',
						'تیر 1403',
						'مرداد 1403',
						'شهریور 1403',
						'مهر 1403',
						'آبان 1403',
						'آذر 1403',
						'دی 1403',
						'بهمن 1403',
						'اسفند 1403',
						'فروردین 1404',
						'اردیبهشت 1404',
						'خرداد 1404',
						'تیر 1404',
					],
					datasets: [
						{
							label: 'شاخص بورس / 10',
							data: [
								20438, 21517, 23389, 25128, 26613, 31147, 30581, 30500, 35672,
								40601, 47876, 51290, 70899, 98676, 130081, 190117, 172726,
								158121, 141235, 136654, 143639, 118398, 123272, 130766, 120705,
								112816, 118691, 131131, 151589, 138647, 140776, 140713, 135901,
								127945, 127430, 136725, 151222, 158214, 153339, 147350, 143148,
								135524, 129680, 140765, 149620, 165758, 159426, 196046, 232413,
								231851, 217389, 210305, 206763, 204992, 203221, 202279, 221186,
								216693, 207078, 219509, 220199, 211256, 204398, 217219, 203721,
								209700, 200728, 225761, 250178, 284994, 271934, 270976, 307792,
								310812, 298461, 284390,
							],
							borderColor: '#3182ce',
							backgroundColor: 'rgba(49, 130, 206, 0.08)',
							fill: true,
							tension: 0.4,
							borderWidth: 3,
							pointRadius: 0,
							pointHoverRadius: 8,
							pointBackgroundColor: '#3182ce',
							pointBorderColor: '#ffffff',
							pointBorderWidth: 2,
							pointHoverBackgroundColor: '#3182ce',
							pointHoverBorderColor: '#ffffff',
						},
						{
							label: 'ارزش کل بورس (میلیارد ریال) / 1000',
							data: [
								6226, 6554, 7124, 7654, 8107, 9488, 9315, 9291, 10866, 12368,
								14583, 15624, 21597, 30058, 39624, 57912, 52615, 48166, 43022,
								41626, 43754, 36066, 37550, 39833, 36768, 34365, 36155, 39944,
								46176, 42234, 42882, 42863, 41397, 38974, 38817, 41648, 46064,
								48194, 46709, 44885, 43605, 41282, 39502, 42879, 45576, 50492,
								48563, 59718, 70796, 70625, 66220, 64062, 62983, 62443, 61904,
								61617, 67376, 66007, 63078, 66865, 67075, 64351, 62262, 66168,
								62056, 63877, 61144, 68770, 76207, 86813, 82835, 82543, 93758,
								94677, 90915, 86629,
							],
							borderColor: '#e53e3e',
							backgroundColor: 'rgba(229, 62, 62, 0.08)',
							fill: true,
							tension: 0.4,
							borderWidth: 3,
							pointRadius: 0,
							pointHoverRadius: 8,
							pointBackgroundColor: '#e53e3e',
							pointBorderColor: '#ffffff',
							pointBorderWidth: 2,
							pointHoverBackgroundColor: '#e53e3e',
							pointHoverBorderColor: '#ffffff',
						},
						{
							label: 'نرخ دلار (ریال) / 10',
							data: [
								13470, 14235, 13200, 12524, 11600, 11393, 11232, 11794, 13169,
								13439, 14393, 14903, 15442, 17701, 19480, 21800, 22502, 27497,
								29644, 25620, 25604, 22645, 25171, 23963, 24184, 22300, 24259,
								24628, 27666, 27521, 27415, 28440, 30077, 27525, 25417, 26252,
								27862, 30323, 31978, 31883, 29344, 31673, 32812, 35658, 39761,
								43976, 49902, 48101, 51607, 52331, 49731, 48336, 49023, 49393,
								50636, 50199, 50076, 54223, 57036, 60351, 60090, 60560, 61480,
								57611, 58160, 59230, 64855, 68930, 76755, 80670, 91995, 97780,
								82790, 83190, 83535, 88110,
							],
							borderColor: '#38a169',
							backgroundColor: 'rgba(56, 161, 105, 0.08)',
							fill: true,
							tension: 0.4,
							borderWidth: 3,
							pointRadius: 0,
							pointHoverRadius: 8,
							pointBackgroundColor: '#38a169',
							pointBorderColor: '#ffffff',
							pointBorderWidth: 2,
							pointHoverBackgroundColor: '#38a169',
							pointHoverBorderColor: '#ffffff',
						},
						{
							label: 'ارزش کل بورس (میلیارد دلار) × 1000',
							data: [
								46218, 46044, 53973, 61117, 69884, 83278, 82935, 78774, 82513,
								92027, 101324, 104835, 139858, 169809, 203411, 265652, 233822,
								175167, 145129, 162476, 170889, 159265, 149180, 166227, 152035,
								154105, 149036, 162190, 166905, 153459, 156418, 150714, 137637,
								141594, 152720, 158648, 165330, 158936, 146067, 140779, 148598,
								130339, 120389, 120251, 114625, 114817, 97317, 124150, 137183,
								134958, 133156, 127704, 124978, 123615, 122252, 122745, 134547,
								121733, 110594, 110794, 111625, 106260, 101272, 114853, 106699,
								107846, 94279, 99768, 99287, 107615, 90042, 84417, 113247,
								113809, 108835, 98319,
							],
							borderColor: '#d69e2e',
							backgroundColor: 'rgba(214, 158, 46, 0.08)',
							fill: true,
							tension: 0.4,
							borderWidth: 3,
							pointRadius: 0,
							pointHoverRadius: 8,
							pointBackgroundColor: '#d69e2e',
							pointBorderColor: '#ffffff',
							pointBorderWidth: 2,
							pointHoverBackgroundColor: '#d69e2e',
							pointHoverBorderColor: '#ffffff',
						},
					],
				},
				options: {
					responsive: true,
					maintainAspectRatio: false,
					devicePixelRatio: 2,
					backgroundColor: '#FFFFFF',
					interaction: {
						intersect: false,
						mode: 'index',
					},
					plugins: {
						legend: {
							position: 'top',
							labels: {
								color: '#1a202c',
								font: {
									size: 13,
									family: "'IRANSansX', sans-serif",
									weight: '600',
								},
								padding: 20,
								usePointStyle: true,
								pointStyle: 'circle',
								boxWidth: 8,
								boxHeight: 8,
							},
						},
						title: {
							display: false,
						},
						tooltip: {
							backgroundColor: 'rgba(26, 32, 44, 0.95)',
							titleColor: '#ffffff',
							bodyColor: '#ffffff',
							borderColor: '#e2e8f0',
							borderWidth: 1,
							cornerRadius: 8,
							displayColors: true,
							titleFont: {
								size: 14,
								family: "'IRANSansX', sans-serif",
								weight: '600',
							},
							bodyFont: {
								size: 13,
								family: "'IRANSansX', sans-serif",
							},
							padding: 12,
							callbacks: {
								label: function (context) {
									const dataIndex = context.dataIndex;
									const datasetIndex = context.datasetIndex;
									const scaledValue = context.parsed.y;

									// Get real value based on dataset
									let realValue;
									let label;

									switch (datasetIndex) {
										case 0: // Stock Index
											realValue = realData.stockIndex[dataIndex];
											label = 'شاخص بورس';
											break;
										case 1: // Market Value Rial
											realValue = realData.marketValueRial[dataIndex];
											label = 'ارزش کل بورس (میلیارد ریال)';
											break;
										case 2: // Dollar Rate
											realValue = realData.dollarRate[dataIndex];
											label = 'نرخ دلار (ریال)';
											break;
										case 3: // Market Value USD
											realValue = realData.marketValueUSD[dataIndex];
											label = 'ارزش کل بورس (میلیارد دلار)';
											break;
										default:
											return context.dataset.label + ': ' + scaledValue;
									}

									// Format the real value with Persian numbers
									const formattedValue = realValue.toLocaleString('fa-IR');
									return label + ': ' + formattedValue;
								},
							},
						},
					},
					scales: {
						y: {
							type: 'linear',
							position: 'left',
							title: {
								display: true,
								text: 'مقادیر مقیاس‌شده',
								color: '#1a202c',
								font: {
									size: 14,
									family: "'IRANSansX', sans-serif",
									weight: '600',
								},
							},
							min: 0,
							max: 350000,
							grid: {
								color: 'rgba(226, 232, 240, 0.8)',
								borderColor: '#e2e8f0',
								drawBorder: true,
								lineWidth: 1,
								drawTicks: false,
							},
							ticks: {
								color: '#718096',
								font: {
									size: 12,
									family: "'IRANSansX', sans-serif",
									weight: '500',
								},
								padding: 8,
								callback: function (value) {
									return value.toLocaleString('fa-IR');
								},
							},
						},
						x: {
							title: {
								display: true,
								text: 'ماه/سال',
								color: '#1a202c',
								font: {
									size: 14,
									family: "'IRANSansX', sans-serif",
									weight: '600',
								},
							},
							grid: {
								color: 'rgba(226, 232, 240, 0.8)',
								drawBorder: true,
								borderColor: '#e2e8f0',
								lineWidth: 1,
								drawTicks: false,
							},
							ticks: {
								maxRotation: 45,
								minRotation: 45,
								color: '#718096',
								font: {
									size: 10,
									family: "'IRANSansX', sans-serif",
									weight: '500',
								},
								padding: 5,
								maxTicksLimit: 84,
								autoSkip: false,
							},
						},
					},
				},
			};

			// Tab switching function
			function switchTab(tabId) {
				// Hide all chart containers
				document.querySelectorAll('.chart-container').forEach((container) => {
					container.classList.remove('active');
				});

				// Remove active class from all tab buttons
				document.querySelectorAll('.tab-button').forEach((button) => {
					button.classList.remove('active');
				});

				// Show selected chart container
				document.getElementById(tabId).classList.add('active');

				// Add active class to clicked button
				event.target.classList.add('active');

				// Update stat boxes based on active chart
				updateStatBoxes(tabId);
			}

			// Function to update stat boxes based on active chart
			function updateStatBoxes(activeTab) {
				const statCards = document.querySelectorAll('.stat-card');

				if (activeTab === 'chart1') {
					// First chart stats (Financial Indicators) - Fixed colors
					statCards.forEach((card) => {
						card.style.display = 'block';
					});

					statCards[0].querySelector('.stat-value').textContent = '3,108,119';
					statCards[0].querySelector('.stat-value').style.color = '#3182ce'; // Blue
					statCards[0].querySelector('.stat-label').textContent =
						'بالاترین شاخص بورس';

					statCards[1].querySelector('.stat-value').textContent = '94,677,309';
					statCards[1].querySelector('.stat-value').style.color = '#e53e3e'; // Red
					statCards[1].querySelector('.stat-label').textContent =
						'بالاترین ارزش کل بورس (ریال)';

					statCards[2].querySelector('.stat-value').textContent = '977,800';
					statCards[2].querySelector('.stat-value').style.color = '#38a169'; // Green
					statCards[2].querySelector('.stat-label').textContent =
						'بالاترین نرخ دلار (ریال)';

					statCards[3].querySelector('.stat-value').textContent = '266';
					statCards[3].querySelector('.stat-value').style.color = '#d69e2e'; // Yellow
					statCards[3].querySelector('.stat-label').textContent =
						'بالاترین ارزش کل بورس (دلار)';
				} else if (activeTab === 'chart2') {
					// Second chart stats (Percentage changes from 1/1/1401)
					statCards.forEach((card) => {
						card.style.display = 'block';
					});

					statCards[0].querySelector('.stat-value').textContent = '445%+';
					statCards[0].querySelector('.stat-value').style.color = '#fbbf24';
					statCards[0].querySelector('.stat-label').textContent =
						'تغییر قیمت طلا (۱۴۰۱-۱۴۰۴)';

					statCards[1].querySelector('.stat-value').textContent = '88%+';
					statCards[1].querySelector('.stat-value').style.color = '#3182ce';
					statCards[1].querySelector('.stat-label').textContent =
						'تغییر شاخص بورس (۱۴۰۱-۱۴۰۴)';

					statCards[2].querySelector('.stat-value').textContent = '241%+';
					statCards[2].querySelector('.stat-value').style.color = '#38a169';
					statCards[2].querySelector('.stat-label').textContent =
						'تغییر نرخ تورم (۱۴۰۱-۱۴۰۴)';

					statCards[3].querySelector('.stat-value').textContent = '249%+';
					statCards[3].querySelector('.stat-value').style.color = '#e53e3e';
					statCards[3].querySelector('.stat-label').textContent =
						'تغییر قیمت مسکن (۱۴۰۱-۱۴۰۴)';
				} else if (activeTab === 'tables') {
					// Tables tab - hide stat boxes
					statCards.forEach((card) => {
						card.style.display = 'none';
					});
				} else if (activeTab === 'comparison') {
					// Comparison tab - hide stat boxes
					statCards.forEach((card) => {
						card.style.display = 'none';
					});

					// Populate comparison tables
					populateComparisonTables();
				}
			}

			const ctx = document.getElementById('myChart').getContext('2d');
			new Chart(ctx, chartData);

			// Second chart configuration
			const chart2Config = {
				type: 'line',
				data: {
					labels: chart2Data.labels,
					datasets: [
						{
							label: 'طلای ۱۸ عیار / 100',
							data: chart2Data.goldData.scaledData,
							borderColor: '#fbbf24',
							backgroundColor: 'rgba(251, 191, 36, 0.08)',
							fill: true,
							tension: 0.4,
							borderWidth: 3,
							pointRadius: 0,
							pointHoverRadius: 8,
							pointBackgroundColor: '#fbbf24',
							pointBorderColor: '#ffffff',
							pointBorderWidth: 2,
							pointHoverBackgroundColor: '#fbbf24',
							pointHoverBorderColor: '#ffffff',
							spanGaps: true,
						},
						{
							label: 'شاخص بورس / 10',
							data: chart2Data.stockIndexData.scaledData,
							borderColor: '#3182ce',
							backgroundColor: 'rgba(49, 130, 206, 0.08)',
							fill: true,
							tension: 0.4,
							borderWidth: 3,
							pointRadius: 0,
							pointHoverRadius: 8,
							pointBackgroundColor: '#3182ce',
							pointBorderColor: '#ffffff',
							pointBorderWidth: 2,
							pointHoverBackgroundColor: '#3182ce',
							pointHoverBorderColor: '#ffffff',
							spanGaps: true,
						},
						{
							label: 'تورم × 200',
							data: chart2Data.inflationData.scaledData,
							borderColor: '#38a169',
							backgroundColor: 'rgba(56, 161, 105, 0.08)',
							fill: true,
							tension: 0.4,
							borderWidth: 3,
							pointRadius: 0,
							pointHoverRadius: 8,
							pointBackgroundColor: '#38a169',
							pointBorderColor: '#ffffff',
							pointBorderWidth: 2,
							pointHoverBackgroundColor: '#38a169',
							pointHoverBorderColor: '#ffffff',
							spanGaps: true,
						},
						{
							label: 'قیمت مسکن / 3',
							data: chart2Data.newData.scaledData,
							borderColor: '#e53e3e',
							backgroundColor: 'rgba(229, 62, 62, 0.08)',
							fill: true,
							tension: 0.4,
							borderWidth: 3,
							pointRadius: 0,
							pointHoverRadius: 8,
							pointBackgroundColor: '#e53e3e',
							pointBorderColor: '#ffffff',
							pointBorderWidth: 2,
							pointHoverBackgroundColor: '#e53e3e',
							pointHoverBorderColor: '#ffffff',
							spanGaps: true,
						},
					],
				},
				options: {
					responsive: true,
					maintainAspectRatio: false,
					devicePixelRatio: 2,
					backgroundColor: '#FFFFFF',
					interaction: {
						intersect: false,
						mode: 'index',
					},
					plugins: {
						legend: {
							position: 'top',
							labels: {
								color: '#1a202c',
								font: {
									size: 13,
									family: "'IRANSansX', sans-serif",
									weight: '600',
								},
								padding: 20,
								usePointStyle: true,
								pointStyle: 'circle',
								boxWidth: 8,
								boxHeight: 8,
							},
						},
						title: {
							display: false,
						},
						tooltip: {
							backgroundColor: 'rgba(26, 32, 44, 0.95)',
							titleColor: '#ffffff',
							bodyColor: '#ffffff',
							borderColor: '#e2e8f0',
							borderWidth: 1,
							cornerRadius: 8,
							displayColors: true,
							titleFont: {
								size: 14,
								family: "'IRANSansX', sans-serif",
								weight: '600',
							},
							bodyFont: {
								size: 13,
								family: "'IRANSansX', sans-serif",
							},
							padding: 12,
							callbacks: {
								label: function (context) {
									const dataIndex = context.dataIndex;
									const datasetIndex = context.datasetIndex;

									if (datasetIndex === 0) {
										// Gold data
										const realValue = chart2Data.goldData.realData[dataIndex];
										const formattedValue = realValue.toLocaleString('fa-IR');
										return 'طلای ۱۸ عیار: ' + formattedValue;
									} else if (datasetIndex === 1) {
										// Stock index data
										const realValue =
											chart2Data.stockIndexData.realData[dataIndex];
										if (realValue === null) {
											return 'شاخص بورس: داده موجود نیست';
										}
										const formattedValue = realValue.toLocaleString('fa-IR');
										return 'شاخص بورس: ' + formattedValue;
									} else if (datasetIndex === 2) {
										// Inflation data
										const realValue =
											chart2Data.inflationData.realData[dataIndex];
										const formattedValue = realValue.toLocaleString('fa-IR');
										return 'تورم: ' + formattedValue;
									} else {
										// Housing price data
										const realValue = chart2Data.newData.realData[dataIndex];
										const formattedValue = realValue.toLocaleString('fa-IR');
										return 'قیمت مسکن: ' + formattedValue;
									}
								},
							},
						},
					},
					scales: {
						y: {
							type: 'linear',
							position: 'left',
							title: {
								display: true,
								text: 'مقادیر مقیاس‌شده',
								color: '#1a202c',
								font: {
									size: 14,
									family: "'IRANSansX', sans-serif",
									weight: '600',
								},
							},
							min: 0,
							max: 900000,
							grid: {
								color: 'rgba(226, 232, 240, 0.8)',
								borderColor: '#e2e8f0',
								drawBorder: true,
								lineWidth: 1,
								drawTicks: false,
							},
							ticks: {
								color: '#718096',
								font: {
									size: 12,
									family: "'IRANSansX', sans-serif",
									weight: '500',
								},
								padding: 8,
								callback: function (value) {
									return value.toLocaleString('fa-IR');
								},
							},
						},
						x: {
							title: {
								display: true,
								text: 'ماه/سال',
								color: '#1a202c',
								font: {
									size: 14,
									family: "'IRANSansX', sans-serif",
									weight: '600',
								},
							},
							grid: {
								color: 'rgba(226, 232, 240, 0.8)',
								drawBorder: true,
								borderColor: '#e2e8f0',
								lineWidth: 1,
								drawTicks: false,
							},
							ticks: {
								maxRotation: 45,
								minRotation: 45,
								color: '#718096',
								font: {
									size: 10,
									family: "'IRANSansX', sans-serif",
									weight: '500',
								},
								padding: 5,
								maxTicksLimit: 52,
								autoSkip: false,
							},
						},
					},
				},
			};

			// Initialize second chart
			const ctx2 = document.getElementById('myChart2').getContext('2d');
			new Chart(ctx2, chart2Config);

			// Initialize table data
			populateSubTable('ev-revenue', 'original');

			// Initialize subcategory buttons for the default category
			updateSubcategoryButtons('ev-revenue');

			// Ensure the first table is visible on page load
			document
				.getElementById('ev-revenue-original-table')
				.classList.add('active');

			// Table functions
			function showCategory(category) {
				// Hide all categories
				document.querySelectorAll('.category-content').forEach((content) => {
					content.classList.remove('active');
				});

				// Remove active class from all category buttons
				document.querySelectorAll('.category-btn').forEach((btn) => {
					btn.classList.remove('active');
				});

				// Show selected category
				document.getElementById(category + '-category').classList.add('active');

				// Add active class to clicked button
				event.target.classList.add('active');

				// Update subcategory button onclick handlers
				updateSubcategoryButtons(category);

				// Reset subcategory to first option (جداول اصلی گزارش) and update subcategory buttons
				showSubTable(category, 'original');

				// Ensure the first subcategory button (جداول اصلی گزارش) is active
				const subcategoryButtons =
					document.querySelectorAll('.subcategory-btn');
				subcategoryButtons.forEach((btn, index) => {
					if (index === 0) {
						btn.classList.add('active');
					} else {
						btn.classList.remove('active');
					}
				});
			}

			function updateSubcategoryButtons(category) {
				const subcategoryButtons =
					document.querySelectorAll('.subcategory-btn');
				subcategoryButtons[0].onclick = () =>
					showSubTable(category, 'original');
				subcategoryButtons[1].onclick = () =>
					showSubTable(category, 'corrected');
				subcategoryButtons[2].onclick = () => showSubTable(category, '2022');
				subcategoryButtons[3].onclick = () => showSubTable(category, 'custom');
			}

			function showSubTable(category, subType) {
				// First, hide all sub-tables across ALL categories
				document.querySelectorAll('.sub-table').forEach((table) => {
					table.classList.remove('active');
				});

				// Remove active class from ALL subcategory buttons across ALL categories
				document.querySelectorAll('.subcategory-btn').forEach((btn) => {
					btn.classList.remove('active');
				});

				// Show selected sub-table
				document
					.getElementById(category + '-' + subType + '-table')
					.classList.add('active');

				// Add active class to clicked button
				event.target.classList.add('active');

				// Populate table data
				populateSubTable(category, subType);
			}

			function populateSubTable(category, subType) {
				// Sample data - replace with actual data
				const sampleData = {
					'ev-revenue': {
						corrected: [
							{
								description:
									'درآمد عملیاتی سال ۱۴۰۳ - ارائه شده توسط شرکت طبق صورتهای مالی حسابرسی نشده',
								amount: 31579776,
								unit: 'میلیون ریال',
							},
							{
								description: 'افزایش ۵۰ درصدی طبق روند سنوات گذشته',
								amount: 15789888,
								unit: 'میلیون ریال',
							},
							{
								description: 'درآمد عملیاتی پیش بینی سال ۱۴۰۴',
								amount: 47369664,
								unit: 'میلیون ریال',
							},
							{
								description: 'متوسط نسبت EV/Revenue شرکتهای مشابه بین المللی',
								amount: 4.6,
								unit: '',
							},
							{
								description:
									'جمع كل ارزش شرکت فناوری ایده پرداز صبا (بدون محاسبه ارزش برند و سایر امتیازات)',
								amount: 217900454,
								unit: 'میلیون ریال',
							},
							{
								description:
									'ارزش تلویحى فيليمو - ۸۰ درصد ارزش شرکت فناوری ایده پرداز صبا',
								amount: 174320364,
								unit: 'میلیون ریال',
							},
							{
								description:
									'ارزش سهام پلتفرم فیلیمو خارج از بورس - تعدیل با تخفیف ۱۸ درصد عدم نقدشوندگی (DLOM) نسبت به بازار بورس ایران',
								amount: 142942698,
								unit: 'میلیون ریال',
							},
							{
								description: 'تفاوت ارزش پلتفرم فیلیمو در صورت ورود به بورس',
								amount: 31377665,
								unit: 'میلیون ریال',
							},
							{
								description:
									'خسارت وارد شده به سهامدار ۱۲ درصدی - آقای مهدی رضوی',
								amount: 3765320,
								unit: 'میلیون ریال',
							},
						],
						original: [
							{
								description: 'درآمد عملیاتی پیش بینی سال ۱۴۰۴',
								amount: 47369664,
								unit: 'میلیون ریال',
							},
							{
								description: 'متوسط نسبت EV/Revenue شرکتهای مشابه بین المللی',
								amount: 5,
								unit: '',
							},
							{
								description: 'جمع كل ارزش شرکت فناوری ایده پرداز صبا',
								amount: 236848320,
								unit: 'میلیون ریال',
							},
							{
								description:
									'ارزش تلویحی فیلیمو - ۸۰ درصد ارزش شرکت فناوری ایده پرداز صبا',
								amount: 189478656,
								unit: 'میلیون ریال',
							},
							{
								description:
									'ارزش سهام پلتفرم فیلیمو خارج از بورس - تعدیل با تخفیف ۱۸ درصد عدم نقدشوندگی (DLOM) نسبت به بازار بورس ایران',
								amount: 155372498,
								unit: 'میلیون ریال',
							},
							{
								description: 'تفاوت ارزش پلتفرم فیلیمو در صورت ورود به بورس',
								amount: 34106158,
								unit: 'میلیون ریال',
							},
							{
								description:
									'خسارت وارد شده به سهامدار ۱۲ درصدی - آقای مهدی رضوی',
								amount: 4092739,
								unit: 'میلیون ریال',
							},
						],
						2022: [
							{
								description: 'درآمد عملیاتی سال ۱۴۰۰',
								amount: 7305556,
								unit: 'میلیون ریال',
							},
							{
								description:
									'متوسط نسبت EV/Revenue شرکتهای مشابه بين المللي (2022)',
								amount: 3,
								unit: '',
							},
							{
								description: 'جمع كل ارزش شرکت فناوری ایده پرداز صبا',
								amount: 21916668,
								unit: 'میلیون ریال',
							},
							{
								description:
									'ارزش تلویحی فیلیمو - ۸۰ درصد ارزش شرکت فناوری ایده پرداز صبا',
								amount: 17533334,
								unit: 'میلیون ریال',
							},
							{
								description:
									'ارزش سهام پلتفرم فیلیمو خارج از بورس - تعدیل با تخفیف ۱۸ درصد عدم نقد شوندگی (DLOM) نسبت به بازار بورس ایران',
								amount: 14377334,
								unit: 'میلیون ریال',
							},
							{
								description: 'تفاوت ارزش پلتفرم فیلیمو در صورت ورود به بورس',
								amount: 3156000,
								unit: 'میلیون ریال',
							},
							{
								description:
									'خسارت وارد شده به سهامدار ۱۲ درصدی - آقای مهدی رضوی',
								amount: 378720,
								unit: 'میلیون ریال',
							},
						],
						custom: [
							{
								description:
									'درآمد عملیاتی سال ۱۴۰۳ - ارائه شده توسط شرکت طبق صورتهای مالی حسابرسی نشده',
								amount: 31579776,
								unit: 'میلیون ریال',
							},
							{
								description: 'افزایش ۵۰ درصدی طبق روند سنوات گذشته',
								amount: 15789888,
								unit: 'میلیون ریال',
							},
							{
								description: 'درآمد عملیاتی پیش بینی سال ۱۴۰۴',
								amount: 47369664,
								unit: 'میلیون ریال',
							},
							{
								description: 'متوسط نسبت EV/Revenue شرکتهای مشابه بین المللی',
								amount: 1.88,
								unit: '',
							},
							{
								description:
									'جمع كل ارزش شرکت فناوری ایده پرداز صبا بدون محاسبه ارزش برند و سایر امتیازات',
								amount: 89054732,
								unit: 'میلیون ریال',
							},
							{
								description:
									'ارزش تلویحی فیلیمو - ۸۰ درصد ارزش شرکت فناوری ایده پرداز صبا',
								amount: 71243975,
								unit: 'میلیون ریال',
							},
							{
								description:
									'ارزش سهام پلتفرم فیلیمو خارج از بورس - تعدیل با تخفیف ۱۸ درصد عدم نقدشوندگی (DLOM) نسبت به بازار بورس ایران',
								amount: 58420059,
								unit: 'میلیون ریال',
							},
							{
								description: 'تفاوت ارزش پلتفرم فیلیمو در صورت ورود به بورس',
								amount: 12823915,
								unit: 'میلیون ریال',
							},
							{
								description:
									'خسارت وارد شده به سهامدار ۱۲ درصدی - آقای مهدی رضوی',
								amount: 1538870,
								unit: 'میلیون ریال',
							},
						],
					},
					pe: {
						corrected: [
							{
								description:
									'متوسط سود خالص پس از کسر مالیات در سنوات ۱۴۰۳ و ۱۴۰۴',
								amount: 8780351,
								unit: 'میلیون ریال',
							},
							{
								description:
									'متوسط P/E شرکتهای مشابه بین المللی با تعدیل نرخ بهره',
								amount: 25,
								unit: '',
							},
							{
								description:
									'جمع كل ارزش شرکت فناوران ایده پرداز صبا (بدون محاسبه ارزش برند و سایر امتیازات)',
								amount: 219508775,
								unit: 'میلیون ریال',
							},
							{
								description:
									'ارزش پلتفرم فیلیمو - ۸۰ درصد ارزش شرکت فناوران ایده پرداز صبا',
								amount: 175607020,
								unit: 'میلیون ریال',
							},
							{
								description:
									'ارزش سهام فیلیمو خارج از بورس - تعدیل با تخفیف ۱۸ درصد نقدشوندگی',
								amount: 143997756,
								unit: 'میلیون ریال',
							},
							{
								description: 'تفاوت ارزش پلتفرم فیلیمو در صورت ورود به بورس',
								amount: 31609264,
								unit: 'میلیون ریال',
							},
							{
								description: 'خسارت وارد به سهامدار ۱۲ درصدی - آقای مهداد رضوی',
								amount: 3793112,
								unit: 'میلیون ریال',
							},
						],
						original: [
							{
								description:
									'متوسط سود خالص پس از کسر مالیات در سنوات ۱۴۰۳ و ۱۴۰۴',
								amount: 8780351,
								unit: 'میلیون ریال',
							},
							{
								description:
									'متوسط P/E شرکتهای مشابه بین المللی با تعدیل نرخ بهره',
								amount: 30,
								unit: '',
							},
							{
								description:
									'جمع كل ارزش شرکت فناوران ایده پرداز صبا (بدون محاسبه ارزش برند و سایر امتیازات)',
								amount: 263410530,
								unit: 'میلیون ریال',
							},
							{
								description:
									'ارزش پلتفرم فیلیمو - ۸۰ درصد ارزش شرکت فناوران ایده پرداز صبا',
								amount: 210728424,
								unit: 'میلیون ریال',
							},
							{
								description:
									'ارزش سهام فیلیمو خارج از بورس - تعدیل با تخفیف ۱۸ درصد نقدشوندگی',
								amount: 172797308,
								unit: 'میلیون ریال',
							},
							{
								description: 'تفاوت ارزش پلتفرم فیلیمو در صورت ورود به بورس',
								amount: 37931116,
								unit: 'میلیون ریال',
							},
							{
								description: 'خسارت وارد به سهامدار ۱۲ درصدی - آقای مهداد رضوی',
								amount: 4551734,
								unit: 'میلیون ریال',
							},
						],
						2022: [
							{
								description: 'سود خالص پس از کسر مالیات در سال ۱۴۰۰',
								amount: 1434749,
								unit: 'میلیون ریال',
							},
							{
								description: 'متوسط P/E شرکتهای مشابه بین المللی (2022)',
								amount: 27.5,
								unit: '',
							},
							{
								description: 'جمع كل ارزش شرکت فناوران ایده پرداز صبا',
								amount: 39455598,
								unit: 'میلیون ریال',
							},
							{
								description:
									'ارزش پلتفرم فیلیمو - ۸۰ درصد ارزش شرکت فناوران ایده پرداز صبا',
								amount: 31564478,
								unit: 'میلیون ریال',
							},
							{
								description:
									'ارزش سهام فیلیمو خارج از بورس - تعدیل با تخفیف ۱۸ درصد نقدشوندگی',
								amount: 25882872,
								unit: 'میلیون ریال',
							},
							{
								description: 'تفاوت ارزش پلتفرم فیلیمو در صورت ورود به بورس',
								amount: 5681606,
								unit: 'میلیون ریال',
							},
							{
								description: 'خسارت وارد به سهامدار ۱۲ درصدی - آقای مهداد رضوی',
								amount: 681793,
								unit: 'میلیون ریال',
							},
						],
						custom: [
							{
								description:
									'متوسط سود خالص پس از کسر مالیات در سنوات ۱۴۰۳ و ۱۴۰۴',
								amount: 8780351,
								unit: 'میلیون ریال',
							},
							{
								description:
									'متوسط P/E شرکتهای مشابه بین المللی با تعدیل نرخ بهره',
								amount: 10.76,
								unit: '',
							},
							{
								description:
									'جمع كل ارزش شرکت فناوران ایده پرداز صبا بدون محاسبه ارزش برند و سایر امتیازات',
								amount: 94476577,
								unit: 'میلیون ریال',
							},
							{
								description:
									'ارزش پلتفرم فیلیمو - ۸۰ درصد ارزش شرکت فناوران ایده پرداز صبا',
								amount: 75581261,
								unit: 'میلیون ریال',
							},
							{
								description:
									'ارزش سهام فیلیمو خارج از بورس - تعدیل با تخفیف ۱۸ درصد نقدشوندگی',
								amount: 61976634,
								unit: 'میلیون ریال',
							},
							{
								description: 'تفاوت ارزش پلتفرم فیلیمو در صورت ورود به بورس',
								amount: 13604627,
								unit: 'میلیون ریال',
							},
							{
								description: 'خسارت وارد به سهامدار ۱۲ درصدی - آقای مهداد رضوی',
								amount: 1632555,
								unit: 'میلیون ریال',
							},
						],
					},
				};

				const tbody = document.getElementById(
					category + '-' + subType + '-body'
				);
				tbody.innerHTML = '';

				const data = sampleData[category][subType];
				const ratioColumn = category === 'ev-revenue' ? 'EV/Revenue' : 'P/E';

				data.forEach((item, index) => {
					const row = document.createElement('tr');

					// Check if this is a financial data table structure (2022, original, corrected, custom, etc.)
					if (
						subType === '2022' ||
						(category === 'pe' && subType === 'original') ||
						(category === 'pe' && subType === 'corrected') ||
						(category === 'pe' && subType === 'custom') ||
						(category === 'ev-revenue' && subType === 'original') ||
						(category === 'ev-revenue' && subType === 'corrected') ||
						(category === 'ev-revenue' && subType === 'custom')
					) {
						row.innerHTML = `
							<td>${index + 1}</td>
							<td>${item.description}</td>
							<td>${item.amount.toLocaleString('fa-IR')}</td>
						`;
					} else {
						// Standard company/ratio structure with enhanced status styling
						const statusClass = getStatusClass(item.status);
						const changeClass = getChangeClass(item.change);

						row.innerHTML = `
							<td>${item.company}</td>
							<td>${item.ratio}</td>
							<td class="${changeClass}">${item.change}</td>
							<td class="${statusClass}">${item.status}</td>
						`;
					}

					tbody.appendChild(row);
				});
			}

			// Helper functions for status and change styling
			function getStatusClass(status) {
				switch (status) {
					case 'بهبود':
						return 'status-improved';
					case 'کاهش':
						return 'status-decreased';
					case 'ثابت':
						return 'status-stable';
					default:
						return '';
				}
			}

			function getChangeClass(change) {
				if (change.startsWith('+')) {
					return 'change-positive';
				} else if (change.startsWith('-')) {
					return 'change-negative';
				} else {
					return 'change-neutral';
				}
			}

			// Comparison companies data
			const comparisonData = {
				evaluatorCompanies: [
					{
						company: 'iQIYI',
						symbol: 'IQ',
						service: 'Pure SVOD (China)',
						pe: 10.22,
					},
					{
						company: 'CuriosityStream',
						symbol: 'CURI',
						service: 'Pure SVOD',
						pe: 8.33,
					},
					{
						company: 'Gaia',
						symbol: 'GAIA',
						service: 'Diversified (Max)',
						pe: 13.85,
					},
					{
						company: 'Warner Bros Discovery',
						symbol: 'WBD',
						service: 'Diversified (+Paramount)',
						pe: 9.08,
					},
					{
						company: 'Paramount Global',
						symbol: 'PARA',
						service: 'Diversified (+Paramount)',
						pe: 16.5,
					},
					{
						company: 'Kuaishou Technology',
						symbol: '1024.HK',
						service: 'live streaming, online marketing (China)',
						pe: 11.54,
					},
					{
						company: 'Roku',
						symbol: 'ROKU',
						service: 'Streaming',
						pe: 10.45,
					},
					{
						company: 'Cineverse',
						symbol: 'CNVS',
						service: 'streaming channels',
						pe: 9.21,
					},
					{
						company: 'Baidu',
						symbol: 'BIDU',
						service: "China's SE",
						pe: 10.37,
					},
					{
						company: 'Coupang Play',
						symbol: 'CPNG',
						service: 'Korean VOD',
						pe: 13.77,
					},
					{
						company: 'Start',
						symbol: 'NMGR',
						service: 'Russian',
						pe: 7.58,
					},
					{
						company: 'TIM Play',
						symbol: 'TIMB',
						service: 'Brazil',
						pe: 8.26,
					},
				],
				evaluatorEvRevenue: [
					{
						company: 'iQIYI',
						symbol: 'IQ',
						service: 'Pure SVOD (China)',
						evRevenue: 0.79,
					},
					{
						company: 'CuriosityStream',
						symbol: 'CURI',
						service: 'Pure SVOD',
						evRevenue: 4.35,
					},
					{
						company: 'Gaia',
						symbol: 'GAIA',
						service: 'Pure SVOD',
						evRevenue: 1.21,
					},
					{
						company: 'Walt Disney Co.',
						symbol: 'DIS',
						service: 'Diversified (+Disney)',
						evRevenue: 2.73,
					},
					{
						company: 'Warner Bros Discovery',
						symbol: 'WBD',
						service: 'Diversified (Max)',
						evRevenue: 1.69,
					},
					{
						company: 'Paramount Global',
						symbol: 'PARA',
						service: 'Diversified (+Paramount)',
						evRevenue: 0.79,
					},
					{
						company: 'Bilibili Inc.',
						symbol: 'BILI',
						service: 'Pure SVOD (China)',
						evRevenue: 1.8,
					},
					{
						company: 'Kuaishou Technology',
						symbol: '1024.HK',
						service: 'live streaming, online marketing (China)',
						evRevenue: 1.8,
					},
					{
						company: 'Roku',
						symbol: 'ROKU',
						service: 'Streaming',
						evRevenue: 2.9,
					},
					{
						company: 'Cineverse',
						symbol: 'CNVS',
						service: 'streaming channels',
						evRevenue: 1.0,
					},
				],
				ourCompanies: [
					{
						brand: 'Netflix',
						parentCompany: '-',
						independentStatus: 'بله',
						independentPE: 'دارد',
						claimedPE: 45,
						description: '',
					},
					{
						brand: '+Disney',
						parentCompany: 'Walt Disney Co. (DIS)',
						independentStatus: 'ندارد',
						independentPE: 'ندارد',
						claimedPE: 50,
						description: 'P/E متعلق به DIS است',
					},
					{
						brand: 'Amazon Prime Video',
						parentCompany: 'Amazon.com Inc.',
						independentStatus: 'ندارد',
						independentPE: 'ندارد',
						claimedPE: 40,
						description: 'فقط Amazon دارای P/E است',
					},
					{
						brand: 'YouTube',
						parentCompany: 'Alphabet Inc. (GOOG)',
						independentStatus: 'ندارد',
						independentPE: 'ندارد',
						claimedPE: 30,
						description: 'فقط Alphabet دارای P/E است',
					},
					{
						brand: 'TikTok',
						parentCompany: 'ByteDance Ltd.',
						independentStatus: 'خصوصی است',
						independentPE: 'ندارد',
						claimedPE: 40,
						description: 'شرکت غیر بورسی است',
					},
					{
						brand: 'Instagram',
						parentCompany: 'Meta Platforms Inc.',
						independentStatus: 'ندارد',
						independentPE: 'ندارد',
						claimedPE: 35,
						description: 'بخشی از Meta است',
					},
					{
						brand: 'Snapchat',
						parentCompany: 'Snap Inc.',
						independentStatus: 'بله',
						independentPE: 'دارد',
						claimedPE: 30,
						description: '',
					},
				],
				ourEvRevenue: [
					{
						company: 'Netflix',
						forecast2025: 6,
						evRevenue2024: 6.3,
					},
					{
						company: '+Disney',
						forecast2025: 4.5,
						evRevenue2024: 4.8,
					},
					{
						company: 'Amazon Prime Video',
						forecast2025: 5,
						evRevenue2024: 5.2,
					},
					{
						company: 'Tencent Video',
						forecast2025: 3.7,
						evRevenue2024: 3.5,
					},
					{
						company: 'Warner Bros. Discovery (HBO Max)',
						forecast2025: 3,
						evRevenue2024: 2.8,
					},
					{
						company: '+Paramount',
						forecast2025: 2.2,
						evRevenue2024: 2,
					},
					{
						company: '+Apple TV',
						forecast2025: 4.3,
						evRevenue2024: 4,
					},
				],
			};

			// Function to switch comparison sub-tabs
			function switchComparisonSubTab(subTabId) {
				// Hide all comparison sub-tables
				document
					.querySelectorAll('.comparison-sub-table')
					.forEach((subTable) => {
						subTable.classList.remove('active');
					});

				// Remove active class from all sub-tab buttons
				document.querySelectorAll('.sub-tab-button').forEach((button) => {
					button.classList.remove('active');
				});

				// Show selected sub-table
				document.getElementById(subTabId).classList.add('active');

				// Add active class to clicked button
				event.target.classList.add('active');
			}

			// Function to populate comparison tables
			function populateComparisonTables() {
				// Populate evaluator P/E companies table
				const evaluatorTbody = document.getElementById(
					'evaluator-companies-body'
				);
				evaluatorTbody.innerHTML = '';

				comparisonData.evaluatorCompanies.forEach((company, index) => {
					const row = document.createElement('tr');
					row.innerHTML = `
						<td>${index + 1}</td>
						<td>${company.company}</td>
						<td>${company.symbol}</td>
						<td>${company.service}</td>
						<td>${company.pe}</td>
					`;
					evaluatorTbody.appendChild(row);
				});

				// Calculate average for evaluator P/E companies (excluding null values)
				const evaluatorValidPEs = comparisonData.evaluatorCompanies
					.filter((company) => company.pe !== '--')
					.map((company) => company.pe);
				const evaluatorPEAverage =
					evaluatorValidPEs.length > 0
						? (
								evaluatorValidPEs.reduce((sum, pe) => sum + pe, 0) /
								evaluatorValidPEs.length
						  ).toFixed(2)
						: '--';

				// Calculate median for evaluator P/E companies
				const evaluatorPEMedian =
					evaluatorValidPEs.length > 0
						? evaluatorValidPEs
								.sort((a, b) => a - b)
								[Math.floor(evaluatorValidPEs.length / 2)].toFixed(2)
						: '--';

				// Add average row for evaluator P/E companies
				const evaluatorPEAverageRow = document.createElement('tr');
				evaluatorPEAverageRow.style.fontWeight = 'bold';
				evaluatorPEAverageRow.style.backgroundColor = '#f7fafc';
				evaluatorPEAverageRow.innerHTML = `
					<td><strong>${comparisonData.evaluatorCompanies.length + 1}</strong></td>
					<td><strong>میانگین</strong></td>
					<td><strong>-</strong></td>
					<td><strong>-</strong></td>
					<td><strong>${evaluatorPEAverage}</strong></td>
				`;
				evaluatorTbody.appendChild(evaluatorPEAverageRow);

				// Add median row for evaluator P/E companies
				const evaluatorPEMedianRow = document.createElement('tr');
				evaluatorPEMedianRow.style.fontWeight = 'bold';
				evaluatorPEMedianRow.style.backgroundColor = '#f7fafc';
				evaluatorPEMedianRow.innerHTML = `
					<td><strong>${comparisonData.evaluatorCompanies.length + 2}</strong></td>
					<td><strong>میانه</strong></td>
					<td><strong>-</strong></td>
					<td><strong>-</strong></td>
					<td><strong>${evaluatorPEMedian}</strong></td>
				`;
				evaluatorTbody.appendChild(evaluatorPEMedianRow);

				// Populate evaluator EV/Revenue companies table
				const evaluatorEvRevenueTbody = document.getElementById(
					'evaluator-ev-revenue-body'
				);
				evaluatorEvRevenueTbody.innerHTML = '';

				comparisonData.evaluatorEvRevenue.forEach((company, index) => {
					const row = document.createElement('tr');
					row.innerHTML = `
						<td>${index + 1}</td>
						<td>${company.company}</td>
						<td>${company.symbol}</td>
						<td>${company.service}</td>
						<td>${company.evRevenue}</td>
					`;
					evaluatorEvRevenueTbody.appendChild(row);
				});

				// Calculate average for evaluator EV/Revenue companies
				const evaluatorValidEvRevenue = comparisonData.evaluatorEvRevenue
					.filter((company) => company.evRevenue !== '--')
					.map((company) => company.evRevenue);
				const evaluatorEvRevenueAverage =
					evaluatorValidEvRevenue.length > 0
						? (
								evaluatorValidEvRevenue.reduce((sum, ev) => sum + ev, 0) /
								evaluatorValidEvRevenue.length
						  ).toFixed(2)
						: '--';

				// Calculate median for evaluator EV/Revenue companies
				const evaluatorEvRevenueMedian =
					evaluatorValidEvRevenue.length > 0
						? evaluatorValidEvRevenue
								.sort((a, b) => a - b)
								[Math.floor(evaluatorValidEvRevenue.length / 2)].toFixed(2)
						: '--';

				// Add average row for evaluator EV/Revenue companies
				const evaluatorEvRevenueAverageRow = document.createElement('tr');
				evaluatorEvRevenueAverageRow.style.fontWeight = 'bold';
				evaluatorEvRevenueAverageRow.style.backgroundColor = '#f7fafc';
				evaluatorEvRevenueAverageRow.innerHTML = `
					<td><strong>${comparisonData.evaluatorEvRevenue.length + 1}</strong></td>
					<td><strong>میانگین</strong></td>
					<td><strong>-</strong></td>
					<td><strong>-</strong></td>
					<td><strong>${evaluatorEvRevenueAverage}</strong></td>
				`;
				evaluatorEvRevenueTbody.appendChild(evaluatorEvRevenueAverageRow);

				// Add median row for evaluator EV/Revenue companies
				const evaluatorEvRevenueMedianRow = document.createElement('tr');
				evaluatorEvRevenueMedianRow.style.fontWeight = 'bold';
				evaluatorEvRevenueMedianRow.style.backgroundColor = '#f7fafc';
				evaluatorEvRevenueMedianRow.innerHTML = `
					<td><strong>${comparisonData.evaluatorEvRevenue.length + 2}</strong></td>
					<td><strong>میانه</strong></td>
					<td><strong>-</strong></td>
					<td><strong>-</strong></td>
					<td><strong>${evaluatorEvRevenueMedian}</strong></td>
				`;
				evaluatorEvRevenueTbody.appendChild(evaluatorEvRevenueMedianRow);

				// Populate our P/E companies table
				const ourTbody = document.getElementById('our-companies-body');
				ourTbody.innerHTML = '';

				comparisonData.ourCompanies.forEach((company, index) => {
					const row = document.createElement('tr');
					row.innerHTML = `
						<td>${index + 1}</td>
						<td>${company.brand}</td>
						<td>${company.parentCompany}</td>
						<td>${company.independentStatus}</td>
						<td>${company.independentPE}</td>
						<td style="color: #e53e3e; font-weight: 600;">${company.claimedPE}</td>
						<td>${company.description}</td>
					`;
					ourTbody.appendChild(row);
				});

				// Populate our EV/Revenue companies table
				const ourEvRevenueTbody = document.getElementById(
					'our-ev-revenue-body'
				);
				ourEvRevenueTbody.innerHTML = '';

				comparisonData.ourEvRevenue.forEach((company, index) => {
					const row = document.createElement('tr');
					row.innerHTML = `
						<td>${index + 1}</td>
						<td>${company.company}</td>
						<td style="color: #e53e3e; font-weight: 600;">${company.evRevenue2024}x</td>
						<td>${company.forecast2025}x</td>
					`;
					ourEvRevenueTbody.appendChild(row);
				});

				// Calculate average for our EV/Revenue companies (2024 values)
				const ourValidEvRevenue2024 = comparisonData.ourEvRevenue
					.filter((company) => company.evRevenue2024 !== '--')
					.map((company) => company.evRevenue2024);
				const ourEvRevenue2024Average =
					ourValidEvRevenue2024.length > 0
						? (
								ourValidEvRevenue2024.reduce((sum, ev) => sum + ev, 0) /
								ourValidEvRevenue2024.length
						  ).toFixed(2)
						: '--';

				// Calculate average for our EV/Revenue companies (2025 forecast)
				const ourValidEvRevenue2025 = comparisonData.ourEvRevenue
					.filter((company) => company.forecast2025 !== '--')
					.map((company) => company.forecast2025);
				const ourEvRevenue2025Average =
					ourValidEvRevenue2025.length > 0
						? (
								ourValidEvRevenue2025.reduce((sum, ev) => sum + ev, 0) /
								ourValidEvRevenue2025.length
						  ).toFixed(2)
						: '--';

				// Calculate median for our EV/Revenue companies (2024 values)
				const ourEvRevenue2024Median =
					ourValidEvRevenue2024.length > 0
						? ourValidEvRevenue2024
								.sort((a, b) => a - b)
								[Math.floor(ourValidEvRevenue2024.length / 2)].toFixed(2)
						: '--';

				// Calculate median for our EV/Revenue companies (2025 forecast)
				const ourEvRevenue2025Median =
					ourValidEvRevenue2025.length > 0
						? ourValidEvRevenue2025
								.sort((a, b) => a - b)
								[Math.floor(ourValidEvRevenue2025.length / 2)].toFixed(2)
						: '--';

				// Add average row for our EV/Revenue companies
				const ourEvRevenueAverageRow = document.createElement('tr');
				ourEvRevenueAverageRow.style.fontWeight = 'bold';
				ourEvRevenueAverageRow.style.backgroundColor = '#f7fafc';
				ourEvRevenueAverageRow.innerHTML = `
					<td><strong>${comparisonData.ourEvRevenue.length + 1}</strong></td>
					<td><strong>میانگین</strong></td>
					<td><strong style="color: #e53e3e;">${ourEvRevenue2024Average}x</strong></td>
					<td><strong>${ourEvRevenue2025Average}x</strong></td>
				`;
				ourEvRevenueTbody.appendChild(ourEvRevenueAverageRow);

				// Add median row for our EV/Revenue companies
				const ourEvRevenueMedianRow = document.createElement('tr');
				ourEvRevenueMedianRow.style.fontWeight = 'bold';
				ourEvRevenueMedianRow.style.backgroundColor = '#f7fafc';
				ourEvRevenueMedianRow.innerHTML = `
					<td><strong>${comparisonData.ourEvRevenue.length + 2}</strong></td>
					<td><strong>میانه</strong></td>
					<td><strong style="color: #e53e3e;">${ourEvRevenue2024Median}x</strong></td>
					<td><strong>${ourEvRevenue2025Median}x</strong></td>
				`;
				ourEvRevenueTbody.appendChild(ourEvRevenueMedianRow);
			}
		</script>
	</body>
</html>
